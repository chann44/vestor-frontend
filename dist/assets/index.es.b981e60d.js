import{e as at}from"./events.b0e980ad.js";import{t as yt}from"./tslib.efbc0765.js";import{c as lt,g as Ic,r as Tc}from"./index.e4390834.js";import{s as rs,a as is,d as ss,f as Bs}from"./index.133cb1eb.js";function Nc(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Ac=Cc;function Cc(t,e,r){var i=r&&r.stringify||Nc,s=1;if(typeof t=="object"&&t!==null){var a=e.length+s;if(a===1)return t;var g=new Array(a);g[0]=i(t);for(var u=1;u<a;u++)g[u]=i(e[u]);return g.join(" ")}if(typeof t!="string")return t;var f=e.length;if(f===0)return t;for(var w="",b=1-s,E=-1,N=t&&t.length||0,v=0;v<N;){if(t.charCodeAt(v)===37&&v+1<N){switch(E=E>-1?E:0,t.charCodeAt(v+1)){case 100:case 102:if(b>=f||e[b]==null)break;E<v&&(w+=t.slice(E,v)),w+=Number(e[b]),E=v+2,v++;break;case 105:if(b>=f||e[b]==null)break;E<v&&(w+=t.slice(E,v)),w+=Math.floor(Number(e[b])),E=v+2,v++;break;case 79:case 111:case 106:if(b>=f||e[b]===void 0)break;E<v&&(w+=t.slice(E,v));var D=typeof e[b];if(D==="string"){w+="'"+e[b]+"'",E=v+2,v++;break}if(D==="function"){w+=e[b].name||"<anonymous>",E=v+2,v++;break}w+=i(e[b]),E=v+2,v++;break;case 115:if(b>=f)break;E<v&&(w+=t.slice(E,v)),w+=String(e[b]),E=v+2,v++;break;case 37:E<v&&(w+=t.slice(E,v)),w+="%",E=v+2,v++,b--;break}++b}++v}return E===-1?t:(E<N&&(w+=t.slice(E)),w)}const qs=Ac;var Rr=It;const Nr=zc().console||{},Pc={mapHttpRequest:Yr,mapHttpResponse:Yr,wrapRequestSerializer:Ei,wrapResponseSerializer:Ei,wrapErrorSerializer:Ei,req:Yr,res:Yr,err:$c};function Rc(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function It(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Nr;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},s=Rc(t.browser.serialize,i);let a=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);const g=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const u=t.level||"info",f=Object.create(r);f.log||(f.log=Ar),Object.defineProperty(f,"levelVal",{get:b}),Object.defineProperty(f,"level",{get:E,set:N});const w={transmit:e,serialize:s,asObject:t.browser.asObject,levels:g,timestamp:Mc(t)};f.levels=It.levels,f.level=u,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=Ar,f.serializers=i,f._serialize=s,f._stdErrSerialize=a,f.child=v,e&&(f._logEvent=ji());function b(){return this.level==="silent"?1/0:this.levels.values[this.level]}function E(){return this._level}function N(D){if(D!=="silent"&&!this.levels.values[D])throw Error("unknown level "+D);this._level=D,ir(w,f,"error","log"),ir(w,f,"fatal","error"),ir(w,f,"warn","error"),ir(w,f,"info","log"),ir(w,f,"debug","log"),ir(w,f,"trace","log")}function v(D,R){if(!D)throw new Error("missing bindings for child Pino");R=R||{},s&&D.serializers&&(R.serializers=D.serializers);const x=R.serializers;if(s&&x){var U=Object.assign({},i,x),c=t.browser.serialize===!0?Object.keys(U):s;delete D.serializers,oi([D],c,U,this._stdErrSerialize)}function d(h){this._childLevel=(h._childLevel|0)+1,this.error=sr(h,D,"error"),this.fatal=sr(h,D,"fatal"),this.warn=sr(h,D,"warn"),this.info=sr(h,D,"info"),this.debug=sr(h,D,"debug"),this.trace=sr(h,D,"trace"),U&&(this.serializers=U,this._serialize=c),e&&(this._logEvent=ji([].concat(h._logEvent.bindings,D)))}return d.prototype=this,new d(this)}return f}It.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};It.stdSerializers=Pc;It.stdTimeFunctions=Object.assign({},{nullTime:vo,epochTime:Do,unixTime:jc,isoTime:Hc});function ir(t,e,r,i){const s=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Ar:s[r]?s[r]:Nr[r]||Nr[i]||Ar,Uc(t,e,r)}function Uc(t,e,r){!t.transmit&&e[r]===Ar||(e[r]=function(i){return function(){const a=t.timestamp(),g=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Nr?Nr:this;for(var f=0;f<g.length;f++)g[f]=arguments[f];if(t.serialize&&!t.asObject&&oi(g,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(u,Fc(this,r,g,a)):i.apply(u,g),t.transmit){const w=t.transmit.level||e.level,b=It.levels.values[w],E=It.levels.values[r];if(E<b)return;Lc(this,{ts:a,methodLevel:r,methodValue:E,transmitLevel:w,transmitValue:It.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},g)}}}(e[r]))}function Fc(t,e,r,i){t._serialize&&oi(r,t._serialize,t.serializers,t._stdErrSerialize);const s=r.slice();let a=s[0];const g={};i&&(g.time=i),g.level=It.levels.values[e];let u=(t._childLevel|0)+1;if(u<1&&(u=1),a!==null&&typeof a=="object"){for(;u--&&typeof s[0]=="object";)Object.assign(g,s.shift());a=s.length?qs(s.shift(),s):void 0}else typeof a=="string"&&(a=qs(s.shift(),s));return a!==void 0&&(g.msg=a),g}function oi(t,e,r,i){for(const s in t)if(i&&t[s]instanceof Error)t[s]=It.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s]))for(const a in t[s])e&&e.indexOf(a)>-1&&a in r&&(t[s][a]=r[a](t[s][a]))}function sr(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return t[r].apply(this,i)}}function Lc(t,e,r){const i=e.send,s=e.ts,a=e.methodLevel,g=e.methodValue,u=e.val,f=t._logEvent.bindings;oi(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=r.filter(function(w){return f.indexOf(w)===-1}),t._logEvent.level.label=a,t._logEvent.level.value=g,i(a,t._logEvent,u),t._logEvent=ji(f)}function ji(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function $c(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Mc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?vo:Do}function Yr(){return{}}function Ei(t){return t}function Ar(){}function vo(){return!1}function Do(){return Date.now()}function jc(){return Math.round(Date.now()/1e3)}function Hc(){return new Date(Date.now()).toISOString()}function zc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var ai={},Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});function Bc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Ur.safeJsonParse=Bc;function qc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Ur.safeJsonStringify=qc;var mr={exports:{}},Ks;function Kc(){return Ks||(Ks=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof lt<"u"&&lt.localStorage?mr.exports=lt.localStorage:typeof window<"u"&&window.localStorage?mr.exports=window.localStorage:mr.exports=new e}()),mr.exports}var vi={},br={},Vs;function Vc(){if(Vs)return br;Vs=1,Object.defineProperty(br,"__esModule",{value:!0}),br.IKeyValueStorage=void 0;class t{}return br.IKeyValueStorage=t,br}var wr={},Gs;function Gc(){if(Gs)return wr;Gs=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.parseEntry=void 0;const t=Ur;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return wr.parseEntry=e,wr}var ks;function kc(){return ks||(ks=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yt.exports;e.__exportStar(Vc(),t),e.__exportStar(Gc(),t)}(vi)),vi}Object.defineProperty(ai,"__esModule",{value:!0});ai.KeyValueStorage=void 0;const cr=yt.exports,Ws=Ur,Wc=cr.__importDefault(Kc()),Yc=kc();class So{constructor(){this.localStorage=Wc.default}getKeys(){return cr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return cr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Yc.parseEntry)})}getItem(e){return cr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Ws.safeJsonParse(r)})}setItem(e,r){return cr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Ws.safeJsonStringify(r))})}removeItem(e){return cr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}ai.KeyValueStorage=So;var Jc=ai.default=So,Fr={},_r={},J={},Di={},Er={},Ys;function Xc(){if(Ys)return Er;Ys=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Er.delay=t,Er}var kt={},Si={},Wt={},Js;function Zc(){return Js||(Js=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ONE_THOUSAND=Wt.ONE_HUNDRED=void 0,Wt.ONE_HUNDRED=100,Wt.ONE_THOUSAND=1e3),Wt}var Oi={},Xs;function Qc(){return Xs||(Xs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Oi)),Oi}var Zs;function Oo(){return Zs||(Zs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yt.exports;e.__exportStar(Zc(),t),e.__exportStar(Qc(),t)}(Si)),Si}var Qs;function eu(){if(Qs)return kt;Qs=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.fromMiliseconds=kt.toMiliseconds=void 0;const t=Oo();function e(i){return i*t.ONE_THOUSAND}kt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return kt.fromMiliseconds=r,kt}var en;function tu(){return en||(en=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yt.exports;e.__exportStar(Xc(),t),e.__exportStar(eu(),t)}(Di)),Di}var nr={},tn;function ru(){if(tn)return nr;tn=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const s=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:s})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return nr.Watch=t,nr.default=t,nr}var xi={},vr={},rn;function iu(){if(rn)return vr;rn=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.IWatch=void 0;class t{}return vr.IWatch=t,vr}var sn;function su(){return sn||(sn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),yt.exports.__exportStar(iu(),t)}(xi)),xi}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yt.exports;e.__exportStar(tu(),t),e.__exportStar(ru(),t),e.__exportStar(su(),t),e.__exportStar(Oo(),t)})(J);var Ii={},Dr={};class Zt{}const nu=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Zt},Symbol.toStringTag,{value:"Module"})),ou=Ic(nu);var nn;function au(){if(nn)return Dr;nn=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.IHeartBeat=void 0;const t=ou;class e extends t.IEvents{constructor(i){super()}}return Dr.IHeartBeat=e,Dr}var on;function xo(){return on||(on=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),yt.exports.__exportStar(au(),t)}(Ii)),Ii}var Ti={},Yt={},an;function cu(){if(an)return Yt;an=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.HEARTBEAT_EVENTS=Yt.HEARTBEAT_INTERVAL=void 0;const t=J;return Yt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Yt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yt}var cn;function Io(){return cn||(cn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),yt.exports.__exportStar(cu(),t)}(Ti)),Ti}var un;function uu(){if(un)return _r;un=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.HeartBeat=void 0;const t=yt.exports,e=at.exports,r=J,i=xo(),s=Io();class a extends i.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(u==null?void 0:u.interval)||s.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const f=new a(u);return yield f.init(),f})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,f){this.events.on(u,f)}once(u,f){this.events.once(u,f)}off(u,f){this.events.off(u,f)}removeListener(u,f){this.events.removeListener(u,f)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return _r.HeartBeat=a,_r}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yt.exports;e.__exportStar(uu(),t),e.__exportStar(xo(),t),e.__exportStar(Io(),t)})(Fr);var Se={},Jt={},hn;function To(){return hn||(hn=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.PINO_CUSTOM_CONTEXT_KEY=Jt.PINO_LOGGER_DEFAULTS=void 0,Jt.PINO_LOGGER_DEFAULTS={level:"info"},Jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Jt}var st={},ln;function hu(){if(ln)return st;ln=1,Object.defineProperty(st,"__esModule",{value:!0}),st.generateChildLogger=st.formatChildLoggerContext=st.getLoggerContext=st.setBrowserLoggerContext=st.getBrowserLoggerContext=st.getDefaultLoggerOptions=void 0;const t=To();function e(u){return Object.assign(Object.assign({},u),{level:(u==null?void 0:u.level)||t.PINO_LOGGER_DEFAULTS.level})}st.getDefaultLoggerOptions=e;function r(u,f=t.PINO_CUSTOM_CONTEXT_KEY){return u[f]||""}st.getBrowserLoggerContext=r;function i(u,f,w=t.PINO_CUSTOM_CONTEXT_KEY){return u[w]=f,u}st.setBrowserLoggerContext=i;function s(u,f=t.PINO_CUSTOM_CONTEXT_KEY){let w="";return typeof u.bindings>"u"?w=r(u,f):w=u.bindings().context||"",w}st.getLoggerContext=s;function a(u,f,w=t.PINO_CUSTOM_CONTEXT_KEY){const b=s(u,w);return b.trim()?`${b}/${f}`:f}st.formatChildLoggerContext=a;function g(u,f,w=t.PINO_CUSTOM_CONTEXT_KEY){const b=a(u,f,w),E=u.child({context:b});return i(E,b,w)}return st.generateChildLogger=g,st}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=yt.exports,r=e.__importDefault(Rr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(To(),t),e.__exportStar(hu(),t)})(Se);class lu extends Zt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class fu extends Zt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class du{constructor(e,r){this.logger=e,this.core=r}}class gu extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class pu extends Zt{constructor(e){super()}}class yu{constructor(e,r,i,s){this.core=e,this.logger=r,this.name=i}}class mu extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class bu extends Zt{constructor(e,r){super(),this.core=e,this.logger=r}}function ns(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Cr(t){return typeof t=="string"?t:JSON.stringify(t)}var os={},ur={},ci={},ui={};Object.defineProperty(ui,"__esModule",{value:!0});ui.BrowserRandomSource=void 0;const fn=65536;class wu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=fn)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,fn)));return r}}ui.BrowserRandomSource=wu;function _u(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hi={},ft={};Object.defineProperty(ft,"__esModule",{value:!0});function Eu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ft.wipe=Eu;Object.defineProperty(hi,"__esModule",{value:!0});hi.NodeRandomSource=void 0;const vu=ft;class Du{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof _u<"u"){const e=Tc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let s=0;s<i.length;s++)i[s]=r[s];return(0,vu.wipe)(r),i}}hi.NodeRandomSource=Du;Object.defineProperty(ci,"__esModule",{value:!0});ci.SystemRandomSource=void 0;const Su=ui,Ou=hi;class xu{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Su.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Ou.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ci.SystemRandomSource=xu;var re={},No={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,f){var w=u>>>16&65535,b=u&65535,E=f>>>16&65535,N=f&65535;return b*N+(w*N+b*E<<16>>>0)|0}t.mul=Math.imul||e;function r(u,f){return u+f|0}t.add=r;function i(u,f){return u-f|0}t.sub=i;function s(u,f){return u<<f|u>>>32-f}t.rotl=s;function a(u,f){return u<<32-f|u>>>f}t.rotr=a;function g(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||g,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(No);Object.defineProperty(re,"__esModule",{value:!0});var Ao=No;function Iu(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=Iu;function Tu(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=Tu;function Nu(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=Nu;function Au(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=Au;function Co(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=Co;re.writeInt16BE=Co;function Po(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=Po;re.writeInt16LE=Po;function Hi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=Hi;function zi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=zi;function Bi(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=Bi;function qi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=qi;function ei(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=ei;re.writeInt32BE=ei;function ti(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=ti;re.writeInt32LE=ti;function Cu(t,e){e===void 0&&(e=0);var r=Hi(t,e),i=Hi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}re.readInt64BE=Cu;function Pu(t,e){e===void 0&&(e=0);var r=zi(t,e),i=zi(t,e+4);return r*4294967296+i}re.readUint64BE=Pu;function Ru(t,e){e===void 0&&(e=0);var r=Bi(t,e),i=Bi(t,e+4);return i*4294967296+r-(r>>31)*4294967296}re.readInt64LE=Ru;function Uu(t,e){e===void 0&&(e=0);var r=qi(t,e),i=qi(t,e+4);return i*4294967296+r}re.readUint64LE=Uu;function Ro(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ei(t/4294967296>>>0,e,r),ei(t>>>0,e,r+4),e}re.writeUint64BE=Ro;re.writeInt64BE=Ro;function Uo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ti(t>>>0,e,r),ti(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=Uo;re.writeInt64LE=Uo;function Fu(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,s=1,a=t/8+r-1;a>=r;a--)i+=e[a]*s,s*=256;return i}re.readUintBE=Fu;function Lu(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,s=1,a=r;a<r+t/8;a++)i+=e[a]*s,s*=256;return i}re.readUintLE=Lu;function $u(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ao.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var s=1,a=t/8+i-1;a>=i;a--)r[a]=e/s&255,s*=256;return r}re.writeUintBE=$u;function Mu(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ao.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var s=1,a=i;a<i+t/8;a++)r[a]=e/s&255,s*=256;return r}re.writeUintLE=Mu;function ju(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=ju;function Hu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=Hu;function zu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=zu;function Bu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=Bu;function qu(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}re.writeFloat32BE=qu;function Ku(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}re.writeFloat32LE=Ku;function Vu(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}re.writeFloat64BE=Vu;function Gu(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}re.writeFloat64LE=Gu;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=ci,r=re,i=ft;t.defaultRandomSource=new e.SystemRandomSource;function s(w,b=t.defaultRandomSource){return b.randomBytes(w)}t.randomBytes=s;function a(w=t.defaultRandomSource){const b=s(4,w),E=(0,r.readUint32LE)(b);return(0,i.wipe)(b),E}t.randomUint32=a;const g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(w,b=g,E=t.defaultRandomSource){if(b.length<2)throw new Error("randomString charset is too short");if(b.length>256)throw new Error("randomString charset is too long");let N="";const v=b.length,D=256-256%v;for(;w>0;){const R=s(Math.ceil(w*256/D),E);for(let x=0;x<R.length&&w>0;x++){const U=R[x];U<D&&(N+=b.charAt(U%v),w--)}(0,i.wipe)(R)}return N}t.randomString=u;function f(w,b=g,E=t.defaultRandomSource){const N=Math.ceil(w/(Math.log(b.length)/Math.LN2));return u(N,b,E)}t.randomStringForEntropy=f})(ur);var Fo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ft;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(f,w){if(w===void 0&&(w=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&w>0;)this._buffer[this._bufferLength++]=f[b++],w--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(b=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,b,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=f[b++],w--;return this},u.prototype.finish=function(f){if(!this._finished){var w=this._bytesHashed,b=this._bufferLength,E=w/536870912|0,N=w<<3,v=w%128<112?128:256;this._buffer[b]=128;for(var D=b+1;D<v-8;D++)this._buffer[D]=0;e.writeUint32BE(E,this._buffer,v-8),e.writeUint32BE(N,this._buffer,v-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)e.writeUint32BE(this._stateHi[D],f,D*8),e.writeUint32BE(this._stateLo[D],f,D*8+4);return this},u.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},u}();t.SHA512=i;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(u,f,w,b,E,N,v){for(var D=w[0],R=w[1],x=w[2],U=w[3],c=w[4],d=w[5],h=w[6],l=w[7],y=b[0],n=b[1],p=b[2],P=b[3],j=b[4],W=b[5],Y=b[6],X=b[7],C,A,G,H,L,$,M,z;v>=128;){for(var ie=0;ie<16;ie++){var B=8*ie+N;u[ie]=e.readUint32BE(E,B),f[ie]=e.readUint32BE(E,B+4)}for(var ie=0;ie<80;ie++){var Z=D,k=R,ae=x,T=U,I=c,S=d,o=h,_=l,q=y,K=n,le=p,me=P,de=j,_e=W,Le=Y,Pe=X;if(C=l,A=X,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=(c>>>14|j<<32-14)^(c>>>18|j<<32-18)^(j>>>41-32|c<<32-(41-32)),A=(j>>>14|c<<32-14)^(j>>>18|c<<32-18)^(c>>>41-32|j<<32-(41-32)),L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,C=c&d^~c&h,A=j&W^~j&Y,L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,C=s[ie*2],A=s[ie*2+1],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,C=u[ie%16],A=f[ie%16],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,G=M&65535|z<<16,H=L&65535|$<<16,C=G,A=H,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=(D>>>28|y<<32-28)^(y>>>34-32|D<<32-(34-32))^(y>>>39-32|D<<32-(39-32)),A=(y>>>28|D<<32-28)^(D>>>34-32|y<<32-(34-32))^(D>>>39-32|y<<32-(39-32)),L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,C=D&R^D&x^R&x,A=y&n^y&p^n&p,L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,_=M&65535|z<<16,Pe=L&65535|$<<16,C=T,A=me,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=G,A=H,L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,T=M&65535|z<<16,me=L&65535|$<<16,R=Z,x=k,U=ae,c=T,d=I,h=S,l=o,D=_,n=q,p=K,P=le,j=me,W=de,Y=_e,X=Le,y=Pe,ie%16===15)for(var B=0;B<16;B++)C=u[B],A=f[B],L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=u[(B+9)%16],A=f[(B+9)%16],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,G=u[(B+1)%16],H=f[(B+1)%16],C=(G>>>1|H<<32-1)^(G>>>8|H<<32-8)^G>>>7,A=(H>>>1|G<<32-1)^(H>>>8|G<<32-8)^(H>>>7|G<<32-7),L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,G=u[(B+14)%16],H=f[(B+14)%16],C=(G>>>19|H<<32-19)^(H>>>61-32|G<<32-(61-32))^G>>>6,A=(H>>>19|G<<32-19)^(G>>>61-32|H<<32-(61-32))^(H>>>6|G<<32-6),L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,u[B]=M&65535|z<<16,f[B]=L&65535|$<<16}C=D,A=y,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[0],A=b[0],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[0]=D=M&65535|z<<16,b[0]=y=L&65535|$<<16,C=R,A=n,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[1],A=b[1],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[1]=R=M&65535|z<<16,b[1]=n=L&65535|$<<16,C=x,A=p,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[2],A=b[2],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[2]=x=M&65535|z<<16,b[2]=p=L&65535|$<<16,C=U,A=P,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[3],A=b[3],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[3]=U=M&65535|z<<16,b[3]=P=L&65535|$<<16,C=c,A=j,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[4],A=b[4],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[4]=c=M&65535|z<<16,b[4]=j=L&65535|$<<16,C=d,A=W,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[5],A=b[5],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[5]=d=M&65535|z<<16,b[5]=W=L&65535|$<<16,C=h,A=Y,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[6],A=b[6],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[6]=h=M&65535|z<<16,b[6]=Y=L&65535|$<<16,C=l,A=X,L=A&65535,$=A>>>16,M=C&65535,z=C>>>16,C=w[7],A=b[7],L+=A&65535,$+=A>>>16,M+=C&65535,z+=C>>>16,$+=L>>>16,M+=$>>>16,z+=M>>>16,w[7]=l=M&65535|z<<16,b[7]=X=L&65535|$<<16,N+=128,v-=128}return N}function g(u){var f=new i;f.update(u);var w=f.digest();return f.clean(),w}t.hash=g})(Fo);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ur,r=Fo,i=ft;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function s(T){const I=new Float64Array(16);if(T)for(let S=0;S<T.length;S++)I[S]=T[S];return I}const a=new Uint8Array(32);a[0]=9;const g=s(),u=s([1]),f=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),w=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),E=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(T,I){for(let S=0;S<16;S++)T[S]=I[S]|0}function D(T){let I=1;for(let S=0;S<16;S++){let o=T[S]+I+65535;I=Math.floor(o/65536),T[S]=o-I*65536}T[0]+=I-1+37*(I-1)}function R(T,I,S){const o=~(S-1);for(let _=0;_<16;_++){const q=o&(T[_]^I[_]);T[_]^=q,I[_]^=q}}function x(T,I){const S=s(),o=s();for(let _=0;_<16;_++)o[_]=I[_];D(o),D(o),D(o);for(let _=0;_<2;_++){S[0]=o[0]-65517;for(let K=1;K<15;K++)S[K]=o[K]-65535-(S[K-1]>>16&1),S[K-1]&=65535;S[15]=o[15]-32767-(S[14]>>16&1);const q=S[15]>>16&1;S[14]&=65535,R(o,S,1-q)}for(let _=0;_<16;_++)T[2*_]=o[_]&255,T[2*_+1]=o[_]>>8}function U(T,I){let S=0;for(let o=0;o<32;o++)S|=T[o]^I[o];return(1&S-1>>>8)-1}function c(T,I){const S=new Uint8Array(32),o=new Uint8Array(32);return x(S,T),x(o,I),U(S,o)}function d(T){const I=new Uint8Array(32);return x(I,T),I[0]&1}function h(T,I){for(let S=0;S<16;S++)T[S]=I[2*S]+(I[2*S+1]<<8);T[15]&=32767}function l(T,I,S){for(let o=0;o<16;o++)T[o]=I[o]+S[o]}function y(T,I,S){for(let o=0;o<16;o++)T[o]=I[o]-S[o]}function n(T,I,S){let o,_,q=0,K=0,le=0,me=0,de=0,_e=0,Le=0,Pe=0,ye=0,ge=0,fe=0,ue=0,ce=0,oe=0,ne=0,ee=0,he=0,pe=0,te=0,be=0,we=0,ve=0,De=0,Ee=0,mt=0,Dt=0,Ft=0,ct=0,qt=0,gr=0,Br=0,$e=S[0],Re=S[1],Me=S[2],je=S[3],He=S[4],Ue=S[5],qe=S[6],Ke=S[7],Ve=S[8],Ge=S[9],ke=S[10],Be=S[11],ze=S[12],Ae=S[13],We=S[14],Ye=S[15];o=I[0],q+=o*$e,K+=o*Re,le+=o*Me,me+=o*je,de+=o*He,_e+=o*Ue,Le+=o*qe,Pe+=o*Ke,ye+=o*Ve,ge+=o*Ge,fe+=o*ke,ue+=o*Be,ce+=o*ze,oe+=o*Ae,ne+=o*We,ee+=o*Ye,o=I[1],K+=o*$e,le+=o*Re,me+=o*Me,de+=o*je,_e+=o*He,Le+=o*Ue,Pe+=o*qe,ye+=o*Ke,ge+=o*Ve,fe+=o*Ge,ue+=o*ke,ce+=o*Be,oe+=o*ze,ne+=o*Ae,ee+=o*We,he+=o*Ye,o=I[2],le+=o*$e,me+=o*Re,de+=o*Me,_e+=o*je,Le+=o*He,Pe+=o*Ue,ye+=o*qe,ge+=o*Ke,fe+=o*Ve,ue+=o*Ge,ce+=o*ke,oe+=o*Be,ne+=o*ze,ee+=o*Ae,he+=o*We,pe+=o*Ye,o=I[3],me+=o*$e,de+=o*Re,_e+=o*Me,Le+=o*je,Pe+=o*He,ye+=o*Ue,ge+=o*qe,fe+=o*Ke,ue+=o*Ve,ce+=o*Ge,oe+=o*ke,ne+=o*Be,ee+=o*ze,he+=o*Ae,pe+=o*We,te+=o*Ye,o=I[4],de+=o*$e,_e+=o*Re,Le+=o*Me,Pe+=o*je,ye+=o*He,ge+=o*Ue,fe+=o*qe,ue+=o*Ke,ce+=o*Ve,oe+=o*Ge,ne+=o*ke,ee+=o*Be,he+=o*ze,pe+=o*Ae,te+=o*We,be+=o*Ye,o=I[5],_e+=o*$e,Le+=o*Re,Pe+=o*Me,ye+=o*je,ge+=o*He,fe+=o*Ue,ue+=o*qe,ce+=o*Ke,oe+=o*Ve,ne+=o*Ge,ee+=o*ke,he+=o*Be,pe+=o*ze,te+=o*Ae,be+=o*We,we+=o*Ye,o=I[6],Le+=o*$e,Pe+=o*Re,ye+=o*Me,ge+=o*je,fe+=o*He,ue+=o*Ue,ce+=o*qe,oe+=o*Ke,ne+=o*Ve,ee+=o*Ge,he+=o*ke,pe+=o*Be,te+=o*ze,be+=o*Ae,we+=o*We,ve+=o*Ye,o=I[7],Pe+=o*$e,ye+=o*Re,ge+=o*Me,fe+=o*je,ue+=o*He,ce+=o*Ue,oe+=o*qe,ne+=o*Ke,ee+=o*Ve,he+=o*Ge,pe+=o*ke,te+=o*Be,be+=o*ze,we+=o*Ae,ve+=o*We,De+=o*Ye,o=I[8],ye+=o*$e,ge+=o*Re,fe+=o*Me,ue+=o*je,ce+=o*He,oe+=o*Ue,ne+=o*qe,ee+=o*Ke,he+=o*Ve,pe+=o*Ge,te+=o*ke,be+=o*Be,we+=o*ze,ve+=o*Ae,De+=o*We,Ee+=o*Ye,o=I[9],ge+=o*$e,fe+=o*Re,ue+=o*Me,ce+=o*je,oe+=o*He,ne+=o*Ue,ee+=o*qe,he+=o*Ke,pe+=o*Ve,te+=o*Ge,be+=o*ke,we+=o*Be,ve+=o*ze,De+=o*Ae,Ee+=o*We,mt+=o*Ye,o=I[10],fe+=o*$e,ue+=o*Re,ce+=o*Me,oe+=o*je,ne+=o*He,ee+=o*Ue,he+=o*qe,pe+=o*Ke,te+=o*Ve,be+=o*Ge,we+=o*ke,ve+=o*Be,De+=o*ze,Ee+=o*Ae,mt+=o*We,Dt+=o*Ye,o=I[11],ue+=o*$e,ce+=o*Re,oe+=o*Me,ne+=o*je,ee+=o*He,he+=o*Ue,pe+=o*qe,te+=o*Ke,be+=o*Ve,we+=o*Ge,ve+=o*ke,De+=o*Be,Ee+=o*ze,mt+=o*Ae,Dt+=o*We,Ft+=o*Ye,o=I[12],ce+=o*$e,oe+=o*Re,ne+=o*Me,ee+=o*je,he+=o*He,pe+=o*Ue,te+=o*qe,be+=o*Ke,we+=o*Ve,ve+=o*Ge,De+=o*ke,Ee+=o*Be,mt+=o*ze,Dt+=o*Ae,Ft+=o*We,ct+=o*Ye,o=I[13],oe+=o*$e,ne+=o*Re,ee+=o*Me,he+=o*je,pe+=o*He,te+=o*Ue,be+=o*qe,we+=o*Ke,ve+=o*Ve,De+=o*Ge,Ee+=o*ke,mt+=o*Be,Dt+=o*ze,Ft+=o*Ae,ct+=o*We,qt+=o*Ye,o=I[14],ne+=o*$e,ee+=o*Re,he+=o*Me,pe+=o*je,te+=o*He,be+=o*Ue,we+=o*qe,ve+=o*Ke,De+=o*Ve,Ee+=o*Ge,mt+=o*ke,Dt+=o*Be,Ft+=o*ze,ct+=o*Ae,qt+=o*We,gr+=o*Ye,o=I[15],ee+=o*$e,he+=o*Re,pe+=o*Me,te+=o*je,be+=o*He,we+=o*Ue,ve+=o*qe,De+=o*Ke,Ee+=o*Ve,mt+=o*Ge,Dt+=o*ke,Ft+=o*Be,ct+=o*ze,qt+=o*Ae,gr+=o*We,Br+=o*Ye,q+=38*he,K+=38*pe,le+=38*te,me+=38*be,de+=38*we,_e+=38*ve,Le+=38*De,Pe+=38*Ee,ye+=38*mt,ge+=38*Dt,fe+=38*Ft,ue+=38*ct,ce+=38*qt,oe+=38*gr,ne+=38*Br,_=1,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=K+_+65535,_=Math.floor(o/65536),K=o-_*65536,o=le+_+65535,_=Math.floor(o/65536),le=o-_*65536,o=me+_+65535,_=Math.floor(o/65536),me=o-_*65536,o=de+_+65535,_=Math.floor(o/65536),de=o-_*65536,o=_e+_+65535,_=Math.floor(o/65536),_e=o-_*65536,o=Le+_+65535,_=Math.floor(o/65536),Le=o-_*65536,o=Pe+_+65535,_=Math.floor(o/65536),Pe=o-_*65536,o=ye+_+65535,_=Math.floor(o/65536),ye=o-_*65536,o=ge+_+65535,_=Math.floor(o/65536),ge=o-_*65536,o=fe+_+65535,_=Math.floor(o/65536),fe=o-_*65536,o=ue+_+65535,_=Math.floor(o/65536),ue=o-_*65536,o=ce+_+65535,_=Math.floor(o/65536),ce=o-_*65536,o=oe+_+65535,_=Math.floor(o/65536),oe=o-_*65536,o=ne+_+65535,_=Math.floor(o/65536),ne=o-_*65536,o=ee+_+65535,_=Math.floor(o/65536),ee=o-_*65536,q+=_-1+37*(_-1),_=1,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=K+_+65535,_=Math.floor(o/65536),K=o-_*65536,o=le+_+65535,_=Math.floor(o/65536),le=o-_*65536,o=me+_+65535,_=Math.floor(o/65536),me=o-_*65536,o=de+_+65535,_=Math.floor(o/65536),de=o-_*65536,o=_e+_+65535,_=Math.floor(o/65536),_e=o-_*65536,o=Le+_+65535,_=Math.floor(o/65536),Le=o-_*65536,o=Pe+_+65535,_=Math.floor(o/65536),Pe=o-_*65536,o=ye+_+65535,_=Math.floor(o/65536),ye=o-_*65536,o=ge+_+65535,_=Math.floor(o/65536),ge=o-_*65536,o=fe+_+65535,_=Math.floor(o/65536),fe=o-_*65536,o=ue+_+65535,_=Math.floor(o/65536),ue=o-_*65536,o=ce+_+65535,_=Math.floor(o/65536),ce=o-_*65536,o=oe+_+65535,_=Math.floor(o/65536),oe=o-_*65536,o=ne+_+65535,_=Math.floor(o/65536),ne=o-_*65536,o=ee+_+65535,_=Math.floor(o/65536),ee=o-_*65536,q+=_-1+37*(_-1),T[0]=q,T[1]=K,T[2]=le,T[3]=me,T[4]=de,T[5]=_e,T[6]=Le,T[7]=Pe,T[8]=ye,T[9]=ge,T[10]=fe,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=ne,T[15]=ee}function p(T,I){n(T,I,I)}function P(T,I){const S=s();let o;for(o=0;o<16;o++)S[o]=I[o];for(o=253;o>=0;o--)p(S,S),o!==2&&o!==4&&n(S,S,I);for(o=0;o<16;o++)T[o]=S[o]}function j(T,I){const S=s();let o;for(o=0;o<16;o++)S[o]=I[o];for(o=250;o>=0;o--)p(S,S),o!==1&&n(S,S,I);for(o=0;o<16;o++)T[o]=S[o]}function W(T,I){const S=s(),o=s(),_=s(),q=s(),K=s(),le=s(),me=s(),de=s(),_e=s();y(S,T[1],T[0]),y(_e,I[1],I[0]),n(S,S,_e),l(o,T[0],T[1]),l(_e,I[0],I[1]),n(o,o,_e),n(_,T[3],I[3]),n(_,_,w),n(q,T[2],I[2]),l(q,q,q),y(K,o,S),y(le,q,_),l(me,q,_),l(de,o,S),n(T[0],K,le),n(T[1],de,me),n(T[2],me,le),n(T[3],K,de)}function Y(T,I,S){for(let o=0;o<4;o++)R(T[o],I[o],S)}function X(T,I){const S=s(),o=s(),_=s();P(_,I[2]),n(S,I[0],_),n(o,I[1],_),x(T,o),T[31]^=d(S)<<7}function C(T,I,S){v(T[0],g),v(T[1],u),v(T[2],u),v(T[3],g);for(let o=255;o>=0;--o){const _=S[o/8|0]>>(o&7)&1;Y(T,I,_),W(I,T),W(T,T),Y(T,I,_)}}function A(T,I){const S=[s(),s(),s(),s()];v(S[0],b),v(S[1],E),v(S[2],u),n(S[3],b,E),C(T,S,I)}function G(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const I=(0,r.hash)(T);I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(32),o=[s(),s(),s(),s()];A(o,I),X(S,o);const _=new Uint8Array(64);return _.set(T),_.set(S,32),{publicKey:S,secretKey:_}}t.generateKeyPairFromSeed=G;function H(T){const I=(0,e.randomBytes)(32,T),S=G(I);return(0,i.wipe)(I),S}t.generateKeyPair=H;function L(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=L;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(T,I){let S,o,_,q;for(o=63;o>=32;--o){for(S=0,_=o-32,q=o-12;_<q;++_)I[_]+=S-16*I[o]*$[_-(o-32)],S=Math.floor((I[_]+128)/256),I[_]-=S*256;I[_]+=S,I[o]=0}for(S=0,_=0;_<32;_++)I[_]+=S-(I[31]>>4)*$[_],S=I[_]>>8,I[_]&=255;for(_=0;_<32;_++)I[_]-=S*$[_];for(o=0;o<32;o++)I[o+1]+=I[o]>>8,T[o]=I[o]&255}function z(T){const I=new Float64Array(64);for(let S=0;S<64;S++)I[S]=T[S];for(let S=0;S<64;S++)T[S]=0;M(T,I)}function ie(T,I){const S=new Float64Array(64),o=[s(),s(),s(),s()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const q=new Uint8Array(64);q.set(_.subarray(32),32);const K=new r.SHA512;K.update(q.subarray(32)),K.update(I);const le=K.digest();K.clean(),z(le),A(o,le),X(q,o),K.reset(),K.update(q.subarray(0,32)),K.update(T.subarray(32)),K.update(I);const me=K.digest();z(me);for(let de=0;de<32;de++)S[de]=le[de];for(let de=0;de<32;de++)for(let _e=0;_e<32;_e++)S[de+_e]+=me[de]*_[_e];return M(q.subarray(32),S),q}t.sign=ie;function B(T,I){const S=s(),o=s(),_=s(),q=s(),K=s(),le=s(),me=s();return v(T[2],u),h(T[1],I),p(_,T[1]),n(q,_,f),y(_,_,T[2]),l(q,T[2],q),p(K,q),p(le,K),n(me,le,K),n(S,me,_),n(S,S,q),j(S,S),n(S,S,_),n(S,S,q),n(S,S,q),n(T[0],S,q),p(o,T[0]),n(o,o,q),c(o,_)&&n(T[0],T[0],N),p(o,T[0]),n(o,o,q),c(o,_)?-1:(d(T[0])===I[31]>>7&&y(T[0],g,T[0]),n(T[3],T[0],T[1]),0)}function Z(T,I,S){const o=new Uint8Array(32),_=[s(),s(),s(),s()],q=[s(),s(),s(),s()];if(S.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(B(q,T))return!1;const K=new r.SHA512;K.update(S.subarray(0,32)),K.update(T),K.update(I);const le=K.digest();return z(le),C(_,q,le),A(q,S.subarray(32)),W(_,q),X(o,_),!U(S,o)}t.verify=Z;function k(T){let I=[s(),s(),s(),s()];if(B(I,T))throw new Error("Ed25519: invalid public key");let S=s(),o=s(),_=I[1];l(S,u,_),y(o,u,_),P(o,o),n(S,S,o);let q=new Uint8Array(32);return x(q,S),q}t.convertPublicKeyToX25519=k;function ae(T){const I=(0,r.hash)(T.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(I.subarray(0,32));return(0,i.wipe)(I),S}t.convertSecretKeyToX25519=ae})(os);const ku="EdDSA",Wu="JWT",Lo=".",$o="base64url",Yu="utf8",Ju="utf8",Xu=":",Zu="did",Qu="key",dn="base58btc",eh="z",th="K36",rh=32;function as(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Mo(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?as(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function ih(t,e){e||(e=t.reduce((s,a)=>s+a.length,0));const r=Mo(e);let i=0;for(const s of t)r.set(s,i),i+=s.length;return as(r)}function sh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<t.length;s++){var a=t.charAt(s),g=a.charCodeAt(0);if(r[g]!==255)throw new TypeError(a+" is ambiguous");r[g]=s}var u=t.length,f=t.charAt(0),w=Math.log(u)/Math.log(256),b=Math.log(256)/Math.log(u);function E(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var R=0,x=0,U=0,c=D.length;U!==c&&D[U]===0;)U++,R++;for(var d=(c-U)*b+1>>>0,h=new Uint8Array(d);U!==c;){for(var l=D[U],y=0,n=d-1;(l!==0||y<x)&&n!==-1;n--,y++)l+=256*h[n]>>>0,h[n]=l%u>>>0,l=l/u>>>0;if(l!==0)throw new Error("Non-zero carry");x=y,U++}for(var p=d-x;p!==d&&h[p]===0;)p++;for(var P=f.repeat(R);p<d;++p)P+=t.charAt(h[p]);return P}function N(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var R=0;if(D[R]!==" "){for(var x=0,U=0;D[R]===f;)x++,R++;for(var c=(D.length-R)*w+1>>>0,d=new Uint8Array(c);D[R];){var h=r[D.charCodeAt(R)];if(h===255)return;for(var l=0,y=c-1;(h!==0||l<U)&&y!==-1;y--,l++)h+=u*d[y]>>>0,d[y]=h%256>>>0,h=h/256>>>0;if(h!==0)throw new Error("Non-zero carry");U=l,R++}if(D[R]!==" "){for(var n=c-U;n!==c&&d[n]===0;)n++;for(var p=new Uint8Array(x+(c-n)),P=x;n!==c;)p[P++]=d[n++];return p}}}function v(D){var R=N(D);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:E,decodeUnsafe:N,decode:v}}var nh=sh,oh=nh;const jo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ah=t=>new TextEncoder().encode(t),ch=t=>new TextDecoder().decode(t);class uh{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hh{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ho(this,e)}}class lh{constructor(e){this.decoders=e}or(e){return Ho(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ho=(t,e)=>new lh({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class fh{constructor(e,r,i,s){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new uh(e,r,i),this.decoder=new hh(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const li=({name:t,prefix:e,encode:r,decode:i})=>new fh(t,e,r,i),Lr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:s}=oh(r,e);return li({prefix:t,name:e,encode:i,decode:a=>jo(s(a))})},dh=(t,e,r,i)=>{const s={};for(let b=0;b<e.length;++b)s[e[b]]=b;let a=t.length;for(;t[a-1]==="=";)--a;const g=new Uint8Array(a*r/8|0);let u=0,f=0,w=0;for(let b=0;b<a;++b){const E=s[t[b]];if(E===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|E,u+=r,u>=8&&(u-=8,g[w++]=255&f>>u)}if(u>=r||255&f<<8-u)throw new SyntaxError("Unexpected end of data");return g},gh=(t,e,r)=>{const i=e[e.length-1]==="=",s=(1<<r)-1;let a="",g=0,u=0;for(let f=0;f<t.length;++f)for(u=u<<8|t[f],g+=8;g>r;)g-=r,a+=e[s&u>>g];if(g&&(a+=e[s&u<<r-g]),i)for(;a.length*r&7;)a+="=";return a},Qe=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>li({prefix:e,name:t,encode(s){return gh(s,i,r)},decode(s){return dh(s,i,r,t)}}),ph=li({prefix:"\0",name:"identity",encode:t=>ch(t),decode:t=>ah(t)}),yh=Object.freeze(Object.defineProperty({__proto__:null,identity:ph},Symbol.toStringTag,{value:"Module"})),mh=Qe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),bh=Object.freeze(Object.defineProperty({__proto__:null,base2:mh},Symbol.toStringTag,{value:"Module"})),wh=Qe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),_h=Object.freeze(Object.defineProperty({__proto__:null,base8:wh},Symbol.toStringTag,{value:"Module"})),Eh=Lr({prefix:"9",name:"base10",alphabet:"0123456789"}),vh=Object.freeze(Object.defineProperty({__proto__:null,base10:Eh},Symbol.toStringTag,{value:"Module"})),Dh=Qe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sh=Qe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Oh=Object.freeze(Object.defineProperty({__proto__:null,base16:Dh,base16upper:Sh},Symbol.toStringTag,{value:"Module"})),xh=Qe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ih=Qe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Th=Qe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Nh=Qe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ah=Qe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ch=Qe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ph=Qe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rh=Qe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Uh=Qe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Fh=Object.freeze(Object.defineProperty({__proto__:null,base32:xh,base32upper:Ih,base32pad:Th,base32padupper:Nh,base32hex:Ah,base32hexupper:Ch,base32hexpad:Ph,base32hexpadupper:Rh,base32z:Uh},Symbol.toStringTag,{value:"Module"})),Lh=Lr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$h=Lr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Mh=Object.freeze(Object.defineProperty({__proto__:null,base36:Lh,base36upper:$h},Symbol.toStringTag,{value:"Module"})),jh=Lr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Hh=Lr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),zh=Object.freeze(Object.defineProperty({__proto__:null,base58btc:jh,base58flickr:Hh},Symbol.toStringTag,{value:"Module"})),Bh=Qe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qh=Qe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kh=Qe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vh=Qe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Gh=Object.freeze(Object.defineProperty({__proto__:null,base64:Bh,base64pad:qh,base64url:Kh,base64urlpad:Vh},Symbol.toStringTag,{value:"Module"})),zo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),kh=zo.reduce((t,e,r)=>(t[r]=e,t),[]),Wh=zo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Yh(t){return t.reduce((e,r)=>(e+=kh[r],e),"")}function Jh(t){const e=[];for(const r of t){const i=Wh[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Xh=li({prefix:"\u{1F680}",name:"base256emoji",encode:Yh,decode:Jh}),Zh=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Xh},Symbol.toStringTag,{value:"Module"}));var Qh=Bo,gn=128,el=127,tl=~el,rl=Math.pow(2,31);function Bo(t,e,r){e=e||[],r=r||0;for(var i=r;t>=rl;)e[r++]=t&255|gn,t/=128;for(;t&tl;)e[r++]=t&255|gn,t>>>=7;return e[r]=t|0,Bo.bytes=r-i+1,e}var il=Ki,sl=128,pn=127;function Ki(t,i){var r=0,i=i||0,s=0,a=i,g,u=t.length;do{if(a>=u)throw Ki.bytes=0,new RangeError("Could not decode varint");g=t[a++],r+=s<28?(g&pn)<<s:(g&pn)*Math.pow(2,s),s+=7}while(g>=sl);return Ki.bytes=a-i,r}var nl=Math.pow(2,7),ol=Math.pow(2,14),al=Math.pow(2,21),cl=Math.pow(2,28),ul=Math.pow(2,35),hl=Math.pow(2,42),ll=Math.pow(2,49),fl=Math.pow(2,56),dl=Math.pow(2,63),gl=function(t){return t<nl?1:t<ol?2:t<al?3:t<cl?4:t<ul?5:t<hl?6:t<ll?7:t<fl?8:t<dl?9:10},pl={encode:Qh,decode:il,encodingLength:gl},qo=pl;const yn=(t,e,r=0)=>(qo.encode(t,e,r),e),mn=t=>qo.encodingLength(t),Vi=(t,e)=>{const r=e.byteLength,i=mn(t),s=i+mn(r),a=new Uint8Array(s+r);return yn(t,a,0),yn(r,a,i),a.set(e,s),new yl(t,r,e,a)};class yl{constructor(e,r,i,s){this.code=e,this.size=r,this.digest=i,this.bytes=s}}const Ko=({name:t,code:e,encode:r})=>new ml(t,e,r);class ml{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Vi(this.code,r):r.then(i=>Vi(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Vo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),bl=Ko({name:"sha2-256",code:18,encode:Vo("SHA-256")}),wl=Ko({name:"sha2-512",code:19,encode:Vo("SHA-512")}),_l=Object.freeze(Object.defineProperty({__proto__:null,sha256:bl,sha512:wl},Symbol.toStringTag,{value:"Module"})),Go=0,El="identity",ko=jo,vl=t=>Vi(Go,ko(t)),Dl={code:Go,name:El,encode:ko,digest:vl},Sl=Object.freeze(Object.defineProperty({__proto__:null,identity:Dl},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ri={...yh,...bh,..._h,...vh,...Oh,...Fh,...Mh,...zh,...Gh,...Zh};({..._l,...Sl});function Wo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const bn=Wo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ni=Wo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Mo(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Yo={utf8:bn,"utf-8":bn,hex:ri.base16,latin1:Ni,ascii:Ni,binary:Ni,...ri};function cs(t,e="utf8"){const r=Yo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function us(t,e="utf8"){const r=Yo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?as(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function ii(t){return cs(us(Cr(t),Yu),$o)}function Jo(t){const e=us(th,dn),r=eh+cs(ih([e,t]),dn);return[Zu,Qu,r].join(Xu)}function Ol(t){return cs(t,$o)}function xl(t){return us([ii(t.header),ii(t.payload)].join(Lo),Ju)}function Il(t){return[ii(t.header),ii(t.payload),Ol(t.signature)].join(Lo)}function wn(t=ur.randomBytes(rh)){return os.generateKeyPairFromSeed(t)}async function Tl(t,e,r,i,s=J.fromMiliseconds(Date.now())){const a={alg:ku,typ:Wu},g=Jo(i.publicKey),u=s+r,f={iss:g,sub:t,aud:e,iat:s,exp:u},w=xl({header:a,payload:f}),b=os.sign(i.secretKey,w);return Il({header:a,payload:f,signature:b})}var hs={},fi={};Object.defineProperty(fi,"__esModule",{value:!0});var rt=re,Gi=ft,Nl=20;function Al(t,e,r){for(var i=1634760805,s=857760878,a=2036477234,g=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],w=r[11]<<24|r[10]<<16|r[9]<<8|r[8],b=r[15]<<24|r[14]<<16|r[13]<<8|r[12],E=r[19]<<24|r[18]<<16|r[17]<<8|r[16],N=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],D=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],x=e[7]<<24|e[6]<<16|e[5]<<8|e[4],U=e[11]<<24|e[10]<<16|e[9]<<8|e[8],c=e[15]<<24|e[14]<<16|e[13]<<8|e[12],d=i,h=s,l=a,y=g,n=u,p=f,P=w,j=b,W=E,Y=N,X=v,C=D,A=R,G=x,H=U,L=c,$=0;$<Nl;$+=2)d=d+n|0,A^=d,A=A>>>32-16|A<<16,W=W+A|0,n^=W,n=n>>>32-12|n<<12,h=h+p|0,G^=h,G=G>>>32-16|G<<16,Y=Y+G|0,p^=Y,p=p>>>32-12|p<<12,l=l+P|0,H^=l,H=H>>>32-16|H<<16,X=X+H|0,P^=X,P=P>>>32-12|P<<12,y=y+j|0,L^=y,L=L>>>32-16|L<<16,C=C+L|0,j^=C,j=j>>>32-12|j<<12,l=l+P|0,H^=l,H=H>>>32-8|H<<8,X=X+H|0,P^=X,P=P>>>32-7|P<<7,y=y+j|0,L^=y,L=L>>>32-8|L<<8,C=C+L|0,j^=C,j=j>>>32-7|j<<7,h=h+p|0,G^=h,G=G>>>32-8|G<<8,Y=Y+G|0,p^=Y,p=p>>>32-7|p<<7,d=d+n|0,A^=d,A=A>>>32-8|A<<8,W=W+A|0,n^=W,n=n>>>32-7|n<<7,d=d+p|0,L^=d,L=L>>>32-16|L<<16,X=X+L|0,p^=X,p=p>>>32-12|p<<12,h=h+P|0,A^=h,A=A>>>32-16|A<<16,C=C+A|0,P^=C,P=P>>>32-12|P<<12,l=l+j|0,G^=l,G=G>>>32-16|G<<16,W=W+G|0,j^=W,j=j>>>32-12|j<<12,y=y+n|0,H^=y,H=H>>>32-16|H<<16,Y=Y+H|0,n^=Y,n=n>>>32-12|n<<12,l=l+j|0,G^=l,G=G>>>32-8|G<<8,W=W+G|0,j^=W,j=j>>>32-7|j<<7,y=y+n|0,H^=y,H=H>>>32-8|H<<8,Y=Y+H|0,n^=Y,n=n>>>32-7|n<<7,h=h+P|0,A^=h,A=A>>>32-8|A<<8,C=C+A|0,P^=C,P=P>>>32-7|P<<7,d=d+p|0,L^=d,L=L>>>32-8|L<<8,X=X+L|0,p^=X,p=p>>>32-7|p<<7;rt.writeUint32LE(d+i|0,t,0),rt.writeUint32LE(h+s|0,t,4),rt.writeUint32LE(l+a|0,t,8),rt.writeUint32LE(y+g|0,t,12),rt.writeUint32LE(n+u|0,t,16),rt.writeUint32LE(p+f|0,t,20),rt.writeUint32LE(P+w|0,t,24),rt.writeUint32LE(j+b|0,t,28),rt.writeUint32LE(W+E|0,t,32),rt.writeUint32LE(Y+N|0,t,36),rt.writeUint32LE(X+v|0,t,40),rt.writeUint32LE(C+D|0,t,44),rt.writeUint32LE(A+R|0,t,48),rt.writeUint32LE(G+x|0,t,52),rt.writeUint32LE(H+U|0,t,56),rt.writeUint32LE(L+c|0,t,60)}function Xo(t,e,r,i,s){if(s===void 0&&(s=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var a,g;if(s===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),g=a.length-e.length,a.set(e,g)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");a=e,g=s}for(var u=new Uint8Array(64),f=0;f<r.length;f+=64){Al(u,a,t);for(var w=f;w<f+64&&w<r.length;w++)i[w]=r[w]^u[w-f];Pl(a,0,g)}return Gi.wipe(u),s===0&&Gi.wipe(a),i}fi.streamXOR=Xo;function Cl(t,e,r,i){return i===void 0&&(i=0),Gi.wipe(r),Xo(t,e,r,r,i)}fi.stream=Cl;function Pl(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Zo={},Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});function Rl(t,e,r){return~(t-1)&e|t-1&r}Bt.select=Rl;function Ul(t,e){return(t|0)-(e|0)-1>>>31&1}Bt.lessOrEqual=Ul;function Qo(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Bt.compare=Qo;function Fl(t,e){return t.length===0||e.length===0?!1:Qo(t,e)!==0}Bt.equal=Fl;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Bt,r=ft;t.DIGEST_LENGTH=16;var i=function(){function g(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=u[0]|u[1]<<8;this._r[0]=f&8191;var w=u[2]|u[3]<<8;this._r[1]=(f>>>13|w<<3)&8191;var b=u[4]|u[5]<<8;this._r[2]=(w>>>10|b<<6)&7939;var E=u[6]|u[7]<<8;this._r[3]=(b>>>7|E<<9)&8191;var N=u[8]|u[9]<<8;this._r[4]=(E>>>4|N<<12)&255,this._r[5]=N>>>1&8190;var v=u[10]|u[11]<<8;this._r[6]=(N>>>14|v<<2)&8191;var D=u[12]|u[13]<<8;this._r[7]=(v>>>11|D<<5)&8065;var R=u[14]|u[15]<<8;this._r[8]=(D>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return g.prototype._blocks=function(u,f,w){for(var b=this._fin?0:2048,E=this._h[0],N=this._h[1],v=this._h[2],D=this._h[3],R=this._h[4],x=this._h[5],U=this._h[6],c=this._h[7],d=this._h[8],h=this._h[9],l=this._r[0],y=this._r[1],n=this._r[2],p=this._r[3],P=this._r[4],j=this._r[5],W=this._r[6],Y=this._r[7],X=this._r[8],C=this._r[9];w>=16;){var A=u[f+0]|u[f+1]<<8;E+=A&8191;var G=u[f+2]|u[f+3]<<8;N+=(A>>>13|G<<3)&8191;var H=u[f+4]|u[f+5]<<8;v+=(G>>>10|H<<6)&8191;var L=u[f+6]|u[f+7]<<8;D+=(H>>>7|L<<9)&8191;var $=u[f+8]|u[f+9]<<8;R+=(L>>>4|$<<12)&8191,x+=$>>>1&8191;var M=u[f+10]|u[f+11]<<8;U+=($>>>14|M<<2)&8191;var z=u[f+12]|u[f+13]<<8;c+=(M>>>11|z<<5)&8191;var ie=u[f+14]|u[f+15]<<8;d+=(z>>>8|ie<<8)&8191,h+=ie>>>5|b;var B=0,Z=B;Z+=E*l,Z+=N*(5*C),Z+=v*(5*X),Z+=D*(5*Y),Z+=R*(5*W),B=Z>>>13,Z&=8191,Z+=x*(5*j),Z+=U*(5*P),Z+=c*(5*p),Z+=d*(5*n),Z+=h*(5*y),B+=Z>>>13,Z&=8191;var k=B;k+=E*y,k+=N*l,k+=v*(5*C),k+=D*(5*X),k+=R*(5*Y),B=k>>>13,k&=8191,k+=x*(5*W),k+=U*(5*j),k+=c*(5*P),k+=d*(5*p),k+=h*(5*n),B+=k>>>13,k&=8191;var ae=B;ae+=E*n,ae+=N*y,ae+=v*l,ae+=D*(5*C),ae+=R*(5*X),B=ae>>>13,ae&=8191,ae+=x*(5*Y),ae+=U*(5*W),ae+=c*(5*j),ae+=d*(5*P),ae+=h*(5*p),B+=ae>>>13,ae&=8191;var T=B;T+=E*p,T+=N*n,T+=v*y,T+=D*l,T+=R*(5*C),B=T>>>13,T&=8191,T+=x*(5*X),T+=U*(5*Y),T+=c*(5*W),T+=d*(5*j),T+=h*(5*P),B+=T>>>13,T&=8191;var I=B;I+=E*P,I+=N*p,I+=v*n,I+=D*y,I+=R*l,B=I>>>13,I&=8191,I+=x*(5*C),I+=U*(5*X),I+=c*(5*Y),I+=d*(5*W),I+=h*(5*j),B+=I>>>13,I&=8191;var S=B;S+=E*j,S+=N*P,S+=v*p,S+=D*n,S+=R*y,B=S>>>13,S&=8191,S+=x*l,S+=U*(5*C),S+=c*(5*X),S+=d*(5*Y),S+=h*(5*W),B+=S>>>13,S&=8191;var o=B;o+=E*W,o+=N*j,o+=v*P,o+=D*p,o+=R*n,B=o>>>13,o&=8191,o+=x*y,o+=U*l,o+=c*(5*C),o+=d*(5*X),o+=h*(5*Y),B+=o>>>13,o&=8191;var _=B;_+=E*Y,_+=N*W,_+=v*j,_+=D*P,_+=R*p,B=_>>>13,_&=8191,_+=x*n,_+=U*y,_+=c*l,_+=d*(5*C),_+=h*(5*X),B+=_>>>13,_&=8191;var q=B;q+=E*X,q+=N*Y,q+=v*W,q+=D*j,q+=R*P,B=q>>>13,q&=8191,q+=x*p,q+=U*n,q+=c*y,q+=d*l,q+=h*(5*C),B+=q>>>13,q&=8191;var K=B;K+=E*C,K+=N*X,K+=v*Y,K+=D*W,K+=R*j,B=K>>>13,K&=8191,K+=x*P,K+=U*p,K+=c*n,K+=d*y,K+=h*l,B+=K>>>13,K&=8191,B=(B<<2)+B|0,B=B+Z|0,Z=B&8191,B=B>>>13,k+=B,E=Z,N=k,v=ae,D=T,R=I,x=S,U=o,c=_,d=q,h=K,f+=16,w-=16}this._h[0]=E,this._h[1]=N,this._h[2]=v,this._h[3]=D,this._h[4]=R,this._h[5]=x,this._h[6]=U,this._h[7]=c,this._h[8]=d,this._h[9]=h},g.prototype.finish=function(u,f){f===void 0&&(f=0);var w=new Uint16Array(10),b,E,N,v;if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(b=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=b,b=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=b*5,b=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=b,b=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=b,w[0]=this._h[0]+5,b=w[0]>>>13,w[0]&=8191,v=1;v<10;v++)w[v]=this._h[v]+b,b=w[v]>>>13,w[v]&=8191;for(w[9]-=1<<13,E=(b^1)-1,v=0;v<10;v++)w[v]&=E;for(E=~E,v=0;v<10;v++)this._h[v]=this._h[v]&E|w[v];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,N=this._h[0]+this._pad[0],this._h[0]=N&65535,v=1;v<8;v++)N=(this._h[v]+this._pad[v]|0)+(N>>>16)|0,this._h[v]=N&65535;return u[f+0]=this._h[0]>>>0,u[f+1]=this._h[0]>>>8,u[f+2]=this._h[1]>>>0,u[f+3]=this._h[1]>>>8,u[f+4]=this._h[2]>>>0,u[f+5]=this._h[2]>>>8,u[f+6]=this._h[3]>>>0,u[f+7]=this._h[3]>>>8,u[f+8]=this._h[4]>>>0,u[f+9]=this._h[4]>>>8,u[f+10]=this._h[5]>>>0,u[f+11]=this._h[5]>>>8,u[f+12]=this._h[6]>>>0,u[f+13]=this._h[6]>>>8,u[f+14]=this._h[7]>>>0,u[f+15]=this._h[7]>>>8,this._finished=!0,this},g.prototype.update=function(u){var f=0,w=u.length,b;if(this._leftover){b=16-this._leftover,b>w&&(b=w);for(var E=0;E<b;E++)this._buffer[this._leftover+E]=u[f+E];if(w-=b,f+=b,this._leftover+=b,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(w>=16&&(b=w-w%16,this._blocks(u,f,b),f+=b,w-=b),w){for(var E=0;E<w;E++)this._buffer[this._leftover+E]=u[f+E];this._leftover+=w}return this},g.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},g.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},g}();t.Poly1305=i;function s(g,u){var f=new i(g);f.update(u);var w=f.digest();return f.clean(),w}t.oneTimeAuth=s;function a(g,u){return g.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(g,u)}t.equal=a})(Zo);(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=fi,r=Zo,i=ft,s=re,a=Bt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var g=new Uint8Array(16),u=function(){function f(w){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,w.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return f.prototype.seal=function(w,b,E,N){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(w,v.length-w.length);var D=new Uint8Array(32);e.stream(this._key,v,D,4);var R=b.length+this.tagLength,x;if(N){if(N.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");x=N}else x=new Uint8Array(R);return e.streamXOR(this._key,v,b,x,4),this._authenticate(x.subarray(x.length-this.tagLength,x.length),D,x.subarray(0,x.length-this.tagLength),E),i.wipe(v),x},f.prototype.open=function(w,b,E,N){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(b.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(w,v.length-w.length);var D=new Uint8Array(32);e.stream(this._key,v,D,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,D,b.subarray(0,b.length-this.tagLength),E),!a.equal(R,b.subarray(b.length-this.tagLength,b.length)))return null;var x=b.length-this.tagLength,U;if(N){if(N.length!==x)throw new Error("ChaCha20Poly1305: incorrect destination length");U=N}else U=new Uint8Array(x);return e.streamXOR(this._key,v,b.subarray(0,b.length-this.tagLength),U,4),i.wipe(v),U},f.prototype.clean=function(){return i.wipe(this._key),this},f.prototype._authenticate=function(w,b,E,N){var v=new r.Poly1305(b);N&&(v.update(N),N.length%16>0&&v.update(g.subarray(N.length%16))),v.update(E),E.length%16>0&&v.update(g.subarray(E.length%16));var D=new Uint8Array(8);N&&s.writeUint64LE(N.length,D),v.update(D),s.writeUint64LE(E.length,D),v.update(D);for(var R=v.digest(),x=0;x<R.length;x++)w[x]=R[x];v.clean(),i.wipe(R),i.wipe(D)},f}();t.ChaCha20Poly1305=u})(hs);var ea={},$r={},ls={};Object.defineProperty(ls,"__esModule",{value:!0});function Ll(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}ls.isSerializableHash=Ll;Object.defineProperty($r,"__esModule",{value:!0});var St=ls,$l=Bt,Ml=ft,ta=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var s=0;s<i.length;s++)i[s]^=54;this._inner.update(i);for(var s=0;s<i.length;s++)i[s]^=106;this._outer.update(i),St.isSerializableHash(this._inner)&&St.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Ml.wipe(i)}return t.prototype.reset=function(){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){St.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),St.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();$r.HMAC=ta;function jl(t,e,r){var i=new ta(t,e);i.update(r);var s=i.digest();return i.clean(),s}$r.hmac=jl;$r.equal=$l.equal;Object.defineProperty(ea,"__esModule",{value:!0});var _n=$r,En=ft,Hl=function(){function t(e,r,i,s){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=s;var a=_n.hmac(this._hash,i,r);this._hmac=new _n.HMAC(e,a),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),En.wipe(this._buffer),En.wipe(this._counter),this._bufpos=0},t}(),zl=ea.HKDF=Hl,di={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ft;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(f,w){if(w===void 0&&(w=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var b=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&w>0;)this._buffer[this._bufferLength++]=f[b++],w--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(b=a(this._temp,this._state,f,b,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=f[b++],w--;return this},u.prototype.finish=function(f){if(!this._finished){var w=this._bytesHashed,b=this._bufferLength,E=w/536870912|0,N=w<<3,v=w%64<56?64:128;this._buffer[b]=128;for(var D=b+1;D<v-8;D++)this._buffer[D]=0;e.writeUint32BE(E,this._buffer,v-8),e.writeUint32BE(N,this._buffer,v-4),a(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)e.writeUint32BE(this._state[D],f,D*4);return this},u.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},u}();t.SHA256=i;var s=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(u,f,w,b,E){for(;E>=64;){for(var N=f[0],v=f[1],D=f[2],R=f[3],x=f[4],U=f[5],c=f[6],d=f[7],h=0;h<16;h++){var l=b+h*4;u[h]=e.readUint32BE(w,l)}for(var h=16;h<64;h++){var y=u[h-2],n=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=u[h-15];var p=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;u[h]=(n+u[h-7]|0)+(p+u[h-16]|0)}for(var h=0;h<64;h++){var n=(((x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7))+(x&U^~x&c)|0)+(d+(s[h]+u[h]|0)|0)|0,p=((N>>>2|N<<32-2)^(N>>>13|N<<32-13)^(N>>>22|N<<32-22))+(N&v^N&D^v&D)|0;d=c,c=U,U=x,x=R+n|0,R=D,D=v,v=N,N=n+p|0}f[0]+=N,f[1]+=v,f[2]+=D,f[3]+=R,f[4]+=x,f[5]+=U,f[6]+=c,f[7]+=d,b+=64,E-=64}return b}function g(u){var f=new i;f.update(u);var w=f.digest();return f.clean(),w}t.hash=g})(di);var fs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ur,r=ft;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(h){const l=new Float64Array(16);if(h)for(let y=0;y<h.length;y++)l[y]=h[y];return l}const s=new Uint8Array(32);s[0]=9;const a=i([56129,1]);function g(h){let l=1;for(let y=0;y<16;y++){let n=h[y]+l+65535;l=Math.floor(n/65536),h[y]=n-l*65536}h[0]+=l-1+37*(l-1)}function u(h,l,y){const n=~(y-1);for(let p=0;p<16;p++){const P=n&(h[p]^l[p]);h[p]^=P,l[p]^=P}}function f(h,l){const y=i(),n=i();for(let p=0;p<16;p++)n[p]=l[p];g(n),g(n),g(n);for(let p=0;p<2;p++){y[0]=n[0]-65517;for(let j=1;j<15;j++)y[j]=n[j]-65535-(y[j-1]>>16&1),y[j-1]&=65535;y[15]=n[15]-32767-(y[14]>>16&1);const P=y[15]>>16&1;y[14]&=65535,u(n,y,1-P)}for(let p=0;p<16;p++)h[2*p]=n[p]&255,h[2*p+1]=n[p]>>8}function w(h,l){for(let y=0;y<16;y++)h[y]=l[2*y]+(l[2*y+1]<<8);h[15]&=32767}function b(h,l,y){for(let n=0;n<16;n++)h[n]=l[n]+y[n]}function E(h,l,y){for(let n=0;n<16;n++)h[n]=l[n]-y[n]}function N(h,l,y){let n,p,P=0,j=0,W=0,Y=0,X=0,C=0,A=0,G=0,H=0,L=0,$=0,M=0,z=0,ie=0,B=0,Z=0,k=0,ae=0,T=0,I=0,S=0,o=0,_=0,q=0,K=0,le=0,me=0,de=0,_e=0,Le=0,Pe=0,ye=y[0],ge=y[1],fe=y[2],ue=y[3],ce=y[4],oe=y[5],ne=y[6],ee=y[7],he=y[8],pe=y[9],te=y[10],be=y[11],we=y[12],ve=y[13],De=y[14],Ee=y[15];n=l[0],P+=n*ye,j+=n*ge,W+=n*fe,Y+=n*ue,X+=n*ce,C+=n*oe,A+=n*ne,G+=n*ee,H+=n*he,L+=n*pe,$+=n*te,M+=n*be,z+=n*we,ie+=n*ve,B+=n*De,Z+=n*Ee,n=l[1],j+=n*ye,W+=n*ge,Y+=n*fe,X+=n*ue,C+=n*ce,A+=n*oe,G+=n*ne,H+=n*ee,L+=n*he,$+=n*pe,M+=n*te,z+=n*be,ie+=n*we,B+=n*ve,Z+=n*De,k+=n*Ee,n=l[2],W+=n*ye,Y+=n*ge,X+=n*fe,C+=n*ue,A+=n*ce,G+=n*oe,H+=n*ne,L+=n*ee,$+=n*he,M+=n*pe,z+=n*te,ie+=n*be,B+=n*we,Z+=n*ve,k+=n*De,ae+=n*Ee,n=l[3],Y+=n*ye,X+=n*ge,C+=n*fe,A+=n*ue,G+=n*ce,H+=n*oe,L+=n*ne,$+=n*ee,M+=n*he,z+=n*pe,ie+=n*te,B+=n*be,Z+=n*we,k+=n*ve,ae+=n*De,T+=n*Ee,n=l[4],X+=n*ye,C+=n*ge,A+=n*fe,G+=n*ue,H+=n*ce,L+=n*oe,$+=n*ne,M+=n*ee,z+=n*he,ie+=n*pe,B+=n*te,Z+=n*be,k+=n*we,ae+=n*ve,T+=n*De,I+=n*Ee,n=l[5],C+=n*ye,A+=n*ge,G+=n*fe,H+=n*ue,L+=n*ce,$+=n*oe,M+=n*ne,z+=n*ee,ie+=n*he,B+=n*pe,Z+=n*te,k+=n*be,ae+=n*we,T+=n*ve,I+=n*De,S+=n*Ee,n=l[6],A+=n*ye,G+=n*ge,H+=n*fe,L+=n*ue,$+=n*ce,M+=n*oe,z+=n*ne,ie+=n*ee,B+=n*he,Z+=n*pe,k+=n*te,ae+=n*be,T+=n*we,I+=n*ve,S+=n*De,o+=n*Ee,n=l[7],G+=n*ye,H+=n*ge,L+=n*fe,$+=n*ue,M+=n*ce,z+=n*oe,ie+=n*ne,B+=n*ee,Z+=n*he,k+=n*pe,ae+=n*te,T+=n*be,I+=n*we,S+=n*ve,o+=n*De,_+=n*Ee,n=l[8],H+=n*ye,L+=n*ge,$+=n*fe,M+=n*ue,z+=n*ce,ie+=n*oe,B+=n*ne,Z+=n*ee,k+=n*he,ae+=n*pe,T+=n*te,I+=n*be,S+=n*we,o+=n*ve,_+=n*De,q+=n*Ee,n=l[9],L+=n*ye,$+=n*ge,M+=n*fe,z+=n*ue,ie+=n*ce,B+=n*oe,Z+=n*ne,k+=n*ee,ae+=n*he,T+=n*pe,I+=n*te,S+=n*be,o+=n*we,_+=n*ve,q+=n*De,K+=n*Ee,n=l[10],$+=n*ye,M+=n*ge,z+=n*fe,ie+=n*ue,B+=n*ce,Z+=n*oe,k+=n*ne,ae+=n*ee,T+=n*he,I+=n*pe,S+=n*te,o+=n*be,_+=n*we,q+=n*ve,K+=n*De,le+=n*Ee,n=l[11],M+=n*ye,z+=n*ge,ie+=n*fe,B+=n*ue,Z+=n*ce,k+=n*oe,ae+=n*ne,T+=n*ee,I+=n*he,S+=n*pe,o+=n*te,_+=n*be,q+=n*we,K+=n*ve,le+=n*De,me+=n*Ee,n=l[12],z+=n*ye,ie+=n*ge,B+=n*fe,Z+=n*ue,k+=n*ce,ae+=n*oe,T+=n*ne,I+=n*ee,S+=n*he,o+=n*pe,_+=n*te,q+=n*be,K+=n*we,le+=n*ve,me+=n*De,de+=n*Ee,n=l[13],ie+=n*ye,B+=n*ge,Z+=n*fe,k+=n*ue,ae+=n*ce,T+=n*oe,I+=n*ne,S+=n*ee,o+=n*he,_+=n*pe,q+=n*te,K+=n*be,le+=n*we,me+=n*ve,de+=n*De,_e+=n*Ee,n=l[14],B+=n*ye,Z+=n*ge,k+=n*fe,ae+=n*ue,T+=n*ce,I+=n*oe,S+=n*ne,o+=n*ee,_+=n*he,q+=n*pe,K+=n*te,le+=n*be,me+=n*we,de+=n*ve,_e+=n*De,Le+=n*Ee,n=l[15],Z+=n*ye,k+=n*ge,ae+=n*fe,T+=n*ue,I+=n*ce,S+=n*oe,o+=n*ne,_+=n*ee,q+=n*he,K+=n*pe,le+=n*te,me+=n*be,de+=n*we,_e+=n*ve,Le+=n*De,Pe+=n*Ee,P+=38*k,j+=38*ae,W+=38*T,Y+=38*I,X+=38*S,C+=38*o,A+=38*_,G+=38*q,H+=38*K,L+=38*le,$+=38*me,M+=38*de,z+=38*_e,ie+=38*Le,B+=38*Pe,p=1,n=P+p+65535,p=Math.floor(n/65536),P=n-p*65536,n=j+p+65535,p=Math.floor(n/65536),j=n-p*65536,n=W+p+65535,p=Math.floor(n/65536),W=n-p*65536,n=Y+p+65535,p=Math.floor(n/65536),Y=n-p*65536,n=X+p+65535,p=Math.floor(n/65536),X=n-p*65536,n=C+p+65535,p=Math.floor(n/65536),C=n-p*65536,n=A+p+65535,p=Math.floor(n/65536),A=n-p*65536,n=G+p+65535,p=Math.floor(n/65536),G=n-p*65536,n=H+p+65535,p=Math.floor(n/65536),H=n-p*65536,n=L+p+65535,p=Math.floor(n/65536),L=n-p*65536,n=$+p+65535,p=Math.floor(n/65536),$=n-p*65536,n=M+p+65535,p=Math.floor(n/65536),M=n-p*65536,n=z+p+65535,p=Math.floor(n/65536),z=n-p*65536,n=ie+p+65535,p=Math.floor(n/65536),ie=n-p*65536,n=B+p+65535,p=Math.floor(n/65536),B=n-p*65536,n=Z+p+65535,p=Math.floor(n/65536),Z=n-p*65536,P+=p-1+37*(p-1),p=1,n=P+p+65535,p=Math.floor(n/65536),P=n-p*65536,n=j+p+65535,p=Math.floor(n/65536),j=n-p*65536,n=W+p+65535,p=Math.floor(n/65536),W=n-p*65536,n=Y+p+65535,p=Math.floor(n/65536),Y=n-p*65536,n=X+p+65535,p=Math.floor(n/65536),X=n-p*65536,n=C+p+65535,p=Math.floor(n/65536),C=n-p*65536,n=A+p+65535,p=Math.floor(n/65536),A=n-p*65536,n=G+p+65535,p=Math.floor(n/65536),G=n-p*65536,n=H+p+65535,p=Math.floor(n/65536),H=n-p*65536,n=L+p+65535,p=Math.floor(n/65536),L=n-p*65536,n=$+p+65535,p=Math.floor(n/65536),$=n-p*65536,n=M+p+65535,p=Math.floor(n/65536),M=n-p*65536,n=z+p+65535,p=Math.floor(n/65536),z=n-p*65536,n=ie+p+65535,p=Math.floor(n/65536),ie=n-p*65536,n=B+p+65535,p=Math.floor(n/65536),B=n-p*65536,n=Z+p+65535,p=Math.floor(n/65536),Z=n-p*65536,P+=p-1+37*(p-1),h[0]=P,h[1]=j,h[2]=W,h[3]=Y,h[4]=X,h[5]=C,h[6]=A,h[7]=G,h[8]=H,h[9]=L,h[10]=$,h[11]=M,h[12]=z,h[13]=ie,h[14]=B,h[15]=Z}function v(h,l){N(h,l,l)}function D(h,l){const y=i();for(let n=0;n<16;n++)y[n]=l[n];for(let n=253;n>=0;n--)v(y,y),n!==2&&n!==4&&N(y,y,l);for(let n=0;n<16;n++)h[n]=y[n]}function R(h,l){const y=new Uint8Array(32),n=new Float64Array(80),p=i(),P=i(),j=i(),W=i(),Y=i(),X=i();for(let H=0;H<31;H++)y[H]=h[H];y[31]=h[31]&127|64,y[0]&=248,w(n,l);for(let H=0;H<16;H++)P[H]=n[H];p[0]=W[0]=1;for(let H=254;H>=0;--H){const L=y[H>>>3]>>>(H&7)&1;u(p,P,L),u(j,W,L),b(Y,p,j),E(p,p,j),b(j,P,W),E(P,P,W),v(W,Y),v(X,p),N(p,j,p),N(j,P,Y),b(Y,p,j),E(p,p,j),v(P,p),E(j,W,X),N(p,j,a),b(p,p,W),N(j,j,p),N(p,W,X),N(W,P,n),v(P,Y),u(p,P,L),u(j,W,L)}for(let H=0;H<16;H++)n[H+16]=p[H],n[H+32]=j[H],n[H+48]=P[H],n[H+64]=W[H];const C=n.subarray(32),A=n.subarray(16);D(C,C),N(A,A,C);const G=new Uint8Array(32);return f(G,A),G}t.scalarMult=R;function x(h){return R(h,s)}t.scalarMultBase=x;function U(h){if(h.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const l=new Uint8Array(h);return{publicKey:x(l),secretKey:l}}t.generateKeyPairFromSeed=U;function c(h){const l=(0,e.randomBytes)(32,h),y=U(l);return(0,r.wipe)(l),y}t.generateKeyPair=c;function d(h,l,y=!1){if(h.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(l.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const n=R(h,l);if(y){let p=0;for(let P=0;P<n.length;P++)p|=n[P];if(p===0)throw new Error("X25519: invalid shared key")}return n}t.sharedKey=d})(fs);function ra(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function vn(t,e){e||(e=t.reduce((s,a)=>s+a.length,0));const r=ra(e);let i=0;for(const s of t)r.set(s,i),i+=s.length;return r}function ia(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Dn=ia("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ai=ia("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=ra(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),sa={utf8:Dn,"utf-8":Dn,hex:ri.base16,latin1:Ai,ascii:Ai,binary:Ai,...ri};function Et(t,e="utf8"){const r=sa[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function vt(t,e="utf8"){const r=sa[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Sn=globalThis&&globalThis.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var i=0,s=e.length,a;i<s;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return t.concat(a||Array.prototype.slice.call(e))},Bl=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),ql=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Kl=function(){function t(e,r,i,s){this.name=e,this.version=r,this.os=i,this.bot=s,this.type="bot-device"}return t}(),Vl=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Gl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),kl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Wl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,On=3,Yl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",kl]],xn=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Jl(t){return t?In(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Gl:typeof navigator<"u"?In(navigator.userAgent):Ql()}function Xl(t){return t!==""&&Yl.reduce(function(e,r){var i=r[0],s=r[1];if(e)return e;var a=s.exec(t);return!!a&&[i,a]},!1)}function In(t){var e=Xl(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Vl;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<On&&(s=Sn(Sn([],s,!0),ef(On-s.length),!0)):s=[];var a=s.join("."),g=Zl(t),u=Wl.exec(t);return u&&u[1]?new Kl(r,a,g,u[1]):new Bl(r,a,g)}function Zl(t){for(var e=0,r=xn.length;e<r;e++){var i=xn[e],s=i[0],a=i[1],g=a.exec(t);if(g)return s}return null}function Ql(){var t=typeof process<"u"&&process.version;return t?new ql(process.version.slice(1)):null}function ef(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=oa=Oe.getLocation=Oe.getLocationOrThrow=ds=Oe.getNavigator=Oe.getNavigatorOrThrow=na=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Qt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Qt;function hr(t){const e=Qt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=hr;function tf(){return hr("document")}Oe.getDocumentOrThrow=tf;function rf(){return Qt("document")}var na=Oe.getDocument=rf;function sf(){return hr("navigator")}Oe.getNavigatorOrThrow=sf;function nf(){return Qt("navigator")}var ds=Oe.getNavigator=nf;function of(){return hr("location")}Oe.getLocationOrThrow=of;function af(){return Qt("location")}var oa=Oe.getLocation=af;function cf(){return hr("crypto")}Oe.getCryptoOrThrow=cf;function uf(){return Qt("crypto")}Oe.getCrypto=uf;function hf(){return hr("localStorage")}Oe.getLocalStorageOrThrow=hf;function lf(){return Qt("localStorage")}Oe.getLocalStorage=lf;var gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.getWindowMetadata=void 0;const Tn=Oe;function ff(){let t,e;try{t=Tn.getDocumentOrThrow(),e=Tn.getLocationOrThrow()}catch{return null}function r(){const E=t.getElementsByTagName("link"),N=[];for(let v=0;v<E.length;v++){const D=E[v],R=D.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const x=D.getAttribute("href");if(x)if(x.toLowerCase().indexOf("https:")===-1&&x.toLowerCase().indexOf("http:")===-1&&x.indexOf("//")!==0){let U=e.protocol+"//"+e.host;if(x.indexOf("/")===0)U+=x;else{const c=e.pathname.split("/");c.pop();const d=c.join("/");U+=d+"/"+x}N.push(U)}else if(x.indexOf("//")===0){const U=e.protocol+x;N.push(U)}else N.push(x)}}return N}function i(...E){const N=t.getElementsByTagName("meta");for(let v=0;v<N.length;v++){const D=N[v],R=["itemprop","property","name"].map(x=>D.getAttribute(x)).filter(x=>x?E.includes(x):!1);if(R.length&&R){const x=D.getAttribute("content");if(x)return x}}return""}function s(){let E=i("name","og:site_name","og:title","twitter:title");return E||(E=t.title),E}function a(){return i("description","og:description","twitter:description","keywords")}const g=s(),u=a(),f=e.origin,w=r();return{description:u,url:f,icons:w,name:g}}gs.getWindowMetadata=ff;var Pr={},ps=function(t,e){for(var r={},i=Object.keys(t),s=Array.isArray(e),a=0;a<i.length;a++){var g=i[a],u=t[g];(s?e.indexOf(g)!==-1:e(g,u,t))&&(r[g]=u)}return r};(function(t){const e=is,r=ss,i=rs,s=ps,a=c=>c==null,g=Symbol("encodeFragmentIdentifier");function u(c){switch(c.arrayFormat){case"index":return d=>(h,l)=>{const y=h.length;return l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),"[",y,"]"].join("")]:[...h,[b(d,c),"[",b(y,c),"]=",b(l,c)].join("")]};case"bracket":return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),"[]"].join("")]:[...h,[b(d,c),"[]=",b(l,c)].join("")];case"colon-list-separator":return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),":list="].join("")]:[...h,[b(d,c),":list=",b(l,c)].join("")];case"comma":case"separator":case"bracket-separator":{const d=c.arrayFormat==="bracket-separator"?"[]=":"=";return h=>(l,y)=>y===void 0||c.skipNull&&y===null||c.skipEmptyString&&y===""?l:(y=y===null?"":y,l.length===0?[[b(h,c),d,b(y,c)].join("")]:[[l,b(y,c)].join(c.arrayFormatSeparator)])}default:return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,b(d,c)]:[...h,[b(d,c),"=",b(l,c)].join("")]}}function f(c){let d;switch(c.arrayFormat){case"index":return(h,l,y)=>{if(d=/\[(\d*)\]$/.exec(h),h=h.replace(/\[\d*\]$/,""),!d){y[h]=l;return}y[h]===void 0&&(y[h]={}),y[h][d[1]]=l};case"bracket":return(h,l,y)=>{if(d=/(\[\])$/.exec(h),h=h.replace(/\[\]$/,""),!d){y[h]=l;return}if(y[h]===void 0){y[h]=[l];return}y[h]=[].concat(y[h],l)};case"colon-list-separator":return(h,l,y)=>{if(d=/(:list)$/.exec(h),h=h.replace(/:list$/,""),!d){y[h]=l;return}if(y[h]===void 0){y[h]=[l];return}y[h]=[].concat(y[h],l)};case"comma":case"separator":return(h,l,y)=>{const n=typeof l=="string"&&l.includes(c.arrayFormatSeparator),p=typeof l=="string"&&!n&&E(l,c).includes(c.arrayFormatSeparator);l=p?E(l,c):l;const P=n||p?l.split(c.arrayFormatSeparator).map(j=>E(j,c)):l===null?l:E(l,c);y[h]=P};case"bracket-separator":return(h,l,y)=>{const n=/(\[\])$/.test(h);if(h=h.replace(/\[\]$/,""),!n){y[h]=l&&E(l,c);return}const p=l===null?[]:l.split(c.arrayFormatSeparator).map(P=>E(P,c));if(y[h]===void 0){y[h]=p;return}y[h]=[].concat(y[h],p)};default:return(h,l,y)=>{if(y[h]===void 0){y[h]=l;return}y[h]=[].concat(y[h],l)}}}function w(c){if(typeof c!="string"||c.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(c,d){return d.encode?d.strict?e(c):encodeURIComponent(c):c}function E(c,d){return d.decode?r(c):c}function N(c){return Array.isArray(c)?c.sort():typeof c=="object"?N(Object.keys(c)).sort((d,h)=>Number(d)-Number(h)).map(d=>c[d]):c}function v(c){const d=c.indexOf("#");return d!==-1&&(c=c.slice(0,d)),c}function D(c){let d="";const h=c.indexOf("#");return h!==-1&&(d=c.slice(h)),d}function R(c){c=v(c);const d=c.indexOf("?");return d===-1?"":c.slice(d+1)}function x(c,d){return d.parseNumbers&&!Number.isNaN(Number(c))&&typeof c=="string"&&c.trim()!==""?c=Number(c):d.parseBooleans&&c!==null&&(c.toLowerCase()==="true"||c.toLowerCase()==="false")&&(c=c.toLowerCase()==="true"),c}function U(c,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),w(d.arrayFormatSeparator);const h=f(d),l=Object.create(null);if(typeof c!="string"||(c=c.trim().replace(/^[?#&]/,""),!c))return l;for(const y of c.split("&")){if(y==="")continue;let[n,p]=i(d.decode?y.replace(/\+/g," "):y,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?p:E(p,d),h(E(n,d),p,l)}for(const y of Object.keys(l)){const n=l[y];if(typeof n=="object"&&n!==null)for(const p of Object.keys(n))n[p]=x(n[p],d);else l[y]=x(n,d)}return d.sort===!1?l:(d.sort===!0?Object.keys(l).sort():Object.keys(l).sort(d.sort)).reduce((y,n)=>{const p=l[n];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?y[n]=N(p):y[n]=p,y},Object.create(null))}t.extract=R,t.parse=U,t.stringify=(c,d)=>{if(!c)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),w(d.arrayFormatSeparator);const h=p=>d.skipNull&&a(c[p])||d.skipEmptyString&&c[p]==="",l=u(d),y={};for(const p of Object.keys(c))h(p)||(y[p]=c[p]);const n=Object.keys(y);return d.sort!==!1&&n.sort(d.sort),n.map(p=>{const P=c[p];return P===void 0?"":P===null?b(p,d):Array.isArray(P)?P.length===0&&d.arrayFormat==="bracket-separator"?b(p,d)+"[]":P.reduce(l(p),[]).join("&"):b(p,d)+"="+b(P,d)}).filter(p=>p.length>0).join("&")},t.parseUrl=(c,d)=>{d=Object.assign({decode:!0},d);const[h,l]=i(c,"#");return Object.assign({url:h.split("?")[0]||"",query:U(R(c),d)},d&&d.parseFragmentIdentifier&&l?{fragmentIdentifier:E(l,d)}:{})},t.stringifyUrl=(c,d)=>{d=Object.assign({encode:!0,strict:!0,[g]:!0},d);const h=v(c.url).split("?")[0]||"",l=t.extract(c.url),y=t.parse(l,{sort:!1}),n=Object.assign(y,c.query);let p=t.stringify(n,d);p&&(p=`?${p}`);let P=D(c.url);return c.fragmentIdentifier&&(P=`#${d[g]?b(c.fragmentIdentifier,d):c.fragmentIdentifier}`),`${h}${p}${P}`},t.pick=(c,d,h)=>{h=Object.assign({parseFragmentIdentifier:!0,[g]:!1},h);const{url:l,query:y,fragmentIdentifier:n}=t.parseUrl(c,h);return t.stringifyUrl({url:l,query:s(y,d),fragmentIdentifier:n},h)},t.exclude=(c,d,h)=>{const l=Array.isArray(d)?y=>!d.includes(y):(y,n)=>!d(y,n);return t.pick(c,l,h)}})(Pr);const df={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},aa="base10",ot="base16",ki="base64pad",ys="utf8",ca=0,lr=1,gf=0,Nn=1,Wi=12,ms=32;function pf(){const t=fs.generateKeyPair();return{privateKey:vt(t.secretKey,ot),publicKey:vt(t.publicKey,ot)}}function Yi(){const t=ur.randomBytes(ms);return vt(t,ot)}function yf(t,e){const r=fs.sharedKey(Et(t,ot),Et(e,ot)),i=new zl(di.SHA256,r).expand(ms);return vt(i,ot)}function mf(t){const e=di.hash(Et(t,ot));return vt(e,ot)}function Ji(t){const e=di.hash(Et(t,ys));return vt(e,ot)}function bf(t){return Et(`${t}`,aa)}function Mr(t){return Number(vt(t,aa))}function wf(t){const e=bf(typeof t.type<"u"?t.type:ca);if(Mr(e)===lr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Et(t.senderPublicKey,ot):void 0,i=typeof t.iv<"u"?Et(t.iv,ot):ur.randomBytes(Wi),s=new hs.ChaCha20Poly1305(Et(t.symKey,ot)).seal(i,Et(t.message,ys));return Ef({type:e,sealed:s,iv:i,senderPublicKey:r})}function _f(t){const e=new hs.ChaCha20Poly1305(Et(t.symKey,ot)),{sealed:r,iv:i}=bs(t.encoded),s=e.open(i,r);if(s===null)throw new Error("Failed to decrypt");return vt(s,ys)}function Ef(t){if(Mr(t.type)===lr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return vt(vn([t.type,t.senderPublicKey,t.iv,t.sealed]),ki)}return vt(vn([t.type,t.iv,t.sealed]),ki)}function bs(t){const e=Et(t,ki),r=e.slice(gf,Nn),i=Nn;if(Mr(r)===lr){const u=i+ms,f=u+Wi,w=e.slice(i,u),b=e.slice(u,f),E=e.slice(f);return{type:r,sealed:E,iv:b,senderPublicKey:w}}const s=i+Wi,a=e.slice(i,s),g=e.slice(s);return{type:r,sealed:g,iv:a}}function vf(t,e){const r=bs(t);return ua({type:Mr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?vt(r.senderPublicKey,ot):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ua(t){const e=(t==null?void 0:t.type)||ca;if(e===lr){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function An(t){return t.type===lr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Df=Object.defineProperty,Cn=Object.getOwnPropertySymbols,Sf=Object.prototype.hasOwnProperty,Of=Object.prototype.propertyIsEnumerable,Pn=(t,e,r)=>e in t?Df(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rn=(t,e)=>{for(var r in e||(e={}))Sf.call(e,r)&&Pn(t,r,e[r]);if(Cn)for(var r of Cn(e))Of.call(e,r)&&Pn(t,r,e[r]);return t};const xf="ReactNative",xr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},If="js";function ha(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Tf(){return!na()&&!!ds()&&navigator.product===xf}function Nf(){return!ha()&&!!ds()}function Af(){return Tf()?xr.reactNative:ha()?xr.node:Nf()?xr.browser:xr.unknown}function Cf(t,e){let r=Pr.parse(t);return r=Rn(Rn({},r),e),t=Pr.stringify(r),t}function Pf(){const t=Jl();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Rf(){var t;const e=Af();return e===xr.browser?[e,((t=oa())==null?void 0:t.host)||"unknown"].join(":"):e}function Uf(t,e,r){const i=Pf(),s=Rf();return[[t,e].join("-"),[If,r].join("-"),i,s].join("/")}function Ff({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:s,projectId:a}){const g=r.split("?"),u=Uf(t,e,i),f={auth:s,ua:u,projectId:a},w=Cf(g[1]||"",f);return g[0]+"?"+w}function la(t){return Object.fromEntries(t.entries())}function fa(t){return new Map(Object.entries(t))}function Ci(t,e){return J.fromMiliseconds((e||Date.now())+J.toMiliseconds(t))}function Un(t){return J.fromMiliseconds(Date.now())>=J.toMiliseconds(t)}function Lf(t){const e=J.toMiliseconds(t||J.FIVE_MINUTES);let r,i,s;return{resolve:a=>{s&&r&&(clearTimeout(s),r(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,g)=>{s=setTimeout(g,e),r=a,i=g})}}function da(t,e){return new Promise(async(r,i)=>{const s=setTimeout(()=>i(),e),a=await t;clearTimeout(s),r(a)})}function ga(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function $f(t){return ga("topic",t)}function Mf(t){return ga("id",t)}function jf(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Pi(t,e){return`${t}${e?`:${e}`:""}`}const Hf="irn";function Xi(t){return(t==null?void 0:t.relay)||{protocol:Hf}}function Zi(t){const e=df[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var zf=Object.defineProperty,Fn=Object.getOwnPropertySymbols,Bf=Object.prototype.hasOwnProperty,qf=Object.prototype.propertyIsEnumerable,Ln=(t,e,r)=>e in t?zf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kf=(t,e)=>{for(var r in e||(e={}))Bf.call(e,r)&&Ln(t,r,e[r]);if(Fn)for(var r of Fn(e))qf.call(e,r)&&Ln(t,r,e[r]);return t};function Vf(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(i)){const a=s.replace(i,""),g=t[s];r[a]=g}}),r}function Gf(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),s=t.substring(e+1,r).split("@"),a=typeof r<"u"?t.substring(r):"",g=Pr.parse(a);return{protocol:i,topic:s[0],version:parseInt(s[1],10),symKey:g.symKey,relay:Vf(g)}}function kf(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(s=>{const a=r+e+s;t[s]&&(i[a]=t[s])}),i}function Wf(t){return`${t.protocol}:${t.topic}@${t.version}?`+Pr.stringify(Kf({symKey:t.symKey},kf(t.relay)))}const Yf={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Jf={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Te(t,e){const{message:r,code:i}=Jf[t];return{message:e?`${r} ${e}`:r,code:i}}function Ir(t,e){const{message:r,code:i}=Yf[t];return{message:e?`${r} ${e}`:r,code:i}}function si(t){return typeof t>"u"}function pa(t,e){return e&&si(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function Xf(t){if(pa(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Zf(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function Qf(t){return t==null?void 0:t.topic}function Ri(t){return typeof t<"u"&&typeof t!==null}const ed="PARSE_ERROR",td="INVALID_REQUEST",rd="METHOD_NOT_FOUND",id="INVALID_PARAMS",ya="INTERNAL_ERROR",ws="SERVER_ERROR",sd=[-32700,-32600,-32601,-32602,-32603],Tr={[ed]:{code:-32700,message:"Parse error"},[td]:{code:-32600,message:"Invalid Request"},[rd]:{code:-32601,message:"Method not found"},[id]:{code:-32602,message:"Invalid params"},[ya]:{code:-32603,message:"Internal error"},[ws]:{code:-32e3,message:"Server error"}},ma=ws;function nd(t){return sd.includes(t)}function $n(t){return Object.keys(Tr).includes(t)?Tr[t]:Tr[ma]}function od(t){const e=Object.values(Tr).find(r=>r.code===t);return e||Tr[ma]}function ba(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var wa={},At={},Mn;function ad(){if(Mn)return At;Mn=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowserCryptoAvailable=At.getSubtleCrypto=At.getBrowerCrypto=void 0;function t(){return(lt===null||lt===void 0?void 0:lt.crypto)||(lt===null||lt===void 0?void 0:lt.msCrypto)||{}}At.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}At.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return At.isBrowserCryptoAvailable=r,At}var Ct={},jn;function cd(){if(jn)return Ct;jn=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.isBrowser=Ct.isNode=Ct.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ct.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ct.isNode=e;function r(){return!t()&&!e()}return Ct.isBrowser=r,Ct}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yt.exports;e.__exportStar(ad(),t),e.__exportStar(cd(),t)})(wa);function ud(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function gi(t,e,r){return{id:r||ud(),jsonrpc:"2.0",method:t,params:e}}function _s(t,e){return{id:t,jsonrpc:"2.0",result:e}}function pi(t,e,r){return{id:t,jsonrpc:"2.0",error:hd(e,r)}}function hd(t,e){return typeof t>"u"?$n(ya):(typeof t=="string"&&(t=Object.assign(Object.assign({},$n(ws)),{message:t})),typeof e<"u"&&(t.data=e),nd(t.code)&&(t=od(t.code)),t)}class ld{}class fd extends ld{constructor(){super()}}class dd extends fd{constructor(e){super()}}const gd="^https?:",pd="^wss?:";function yd(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function _a(t,e){const r=yd(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Hn(t){return _a(t,gd)}function zn(t){return _a(t,pd)}function md(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Ea(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Es(t){return Ea(t)&&"method"in t}function vs(t){return Ea(t)&&(Rt(t)||_t(t))}function Rt(t){return"result"in t}function _t(t){return"error"in t}class jr extends dd{constructor(e){super(e),this.events=new at.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(gi(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(a){s(a)}this.events.on(`${e.id}`,a=>{_t(a)?s(a.error):i(a.result)});try{await this.connection.send(e,r)}catch(a){s(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),vs(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const Bn=10,bd=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),wd=()=>typeof window<"u",_d=bd();class Ed{constructor(e){if(this.url=e,this.events=new at.exports.EventEmitter,this.registering=!1,!zn(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Cr(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!zn(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const s=wa.isReactNative()?void 0:{rejectUnauthorized:!md(e)},a=new _d(e,[],s);wd()?a.onerror=g=>{const u=g;i(this.emitError(u.error))}:a.on("error",g=>{i(this.emitError(g))}),a.onopen=()=>{this.onOpen(a),r(a)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?ns(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),s=i.message||i.toString(),a=pi(e,s);this.events.emit("payload",a)}parseError(e,r=this.url){return ba(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Bn&&this.events.setMaxListeners(Bn)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Qi={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",s=1,a=2,g=9007199254740991,u="[object Arguments]",f="[object Array]",w="[object AsyncFunction]",b="[object Boolean]",E="[object Date]",N="[object Error]",v="[object Function]",D="[object GeneratorFunction]",R="[object Map]",x="[object Number]",U="[object Null]",c="[object Object]",d="[object Promise]",h="[object Proxy]",l="[object RegExp]",y="[object Set]",n="[object String]",p="[object Symbol]",P="[object Undefined]",j="[object WeakMap]",W="[object ArrayBuffer]",Y="[object DataView]",X="[object Float32Array]",C="[object Float64Array]",A="[object Int8Array]",G="[object Int16Array]",H="[object Int32Array]",L="[object Uint8Array]",$="[object Uint8ClampedArray]",M="[object Uint16Array]",z="[object Uint32Array]",ie=/[\\^$.*+?()[\]{}|]/g,B=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,k={};k[X]=k[C]=k[A]=k[G]=k[H]=k[L]=k[$]=k[M]=k[z]=!0,k[u]=k[f]=k[W]=k[b]=k[Y]=k[E]=k[N]=k[v]=k[R]=k[x]=k[c]=k[l]=k[y]=k[n]=k[j]=!1;var ae=typeof lt=="object"&&lt&&lt.Object===Object&&lt,T=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||T||Function("return this")(),S=e&&!e.nodeType&&e,o=S&&!0&&t&&!t.nodeType&&t,_=o&&o.exports===S,q=_&&ae.process,K=function(){try{return q&&q.binding&&q.binding("util")}catch{}}(),le=K&&K.isTypedArray;function me(m,O){for(var F=-1,V=m==null?0:m.length,Ne=0,se=[];++F<V;){var Fe=m[F];O(Fe,F,m)&&(se[Ne++]=Fe)}return se}function de(m,O){for(var F=-1,V=O.length,Ne=m.length;++F<V;)m[Ne+F]=O[F];return m}function _e(m,O){for(var F=-1,V=m==null?0:m.length;++F<V;)if(O(m[F],F,m))return!0;return!1}function Le(m,O){for(var F=-1,V=Array(m);++F<m;)V[F]=O(F);return V}function Pe(m){return function(O){return m(O)}}function ye(m,O){return m.has(O)}function ge(m,O){return m==null?void 0:m[O]}function fe(m){var O=-1,F=Array(m.size);return m.forEach(function(V,Ne){F[++O]=[Ne,V]}),F}function ue(m,O){return function(F){return m(O(F))}}function ce(m){var O=-1,F=Array(m.size);return m.forEach(function(V){F[++O]=V}),F}var oe=Array.prototype,ne=Function.prototype,ee=Object.prototype,he=I["__core-js_shared__"],pe=ne.toString,te=ee.hasOwnProperty,be=function(){var m=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),we=ee.toString,ve=RegExp("^"+pe.call(te).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=_?I.Buffer:void 0,Ee=I.Symbol,mt=I.Uint8Array,Dt=ee.propertyIsEnumerable,Ft=oe.splice,ct=Ee?Ee.toStringTag:void 0,qt=Object.getOwnPropertySymbols,gr=De?De.isBuffer:void 0,Br=ue(Object.keys,Object),$e=rr(I,"DataView"),Re=rr(I,"Map"),Me=rr(I,"Promise"),je=rr(I,"Set"),He=rr(I,"WeakMap"),Ue=rr(Object,"create"),qe=Vt($e),Ke=Vt(Re),Ve=Vt(Me),Ge=Vt(je),ke=Vt(He),Be=Ee?Ee.prototype:void 0,ze=Be?Be.valueOf:void 0;function Ae(m){var O=-1,F=m==null?0:m.length;for(this.clear();++O<F;){var V=m[O];this.set(V[0],V[1])}}function We(){this.__data__=Ue?Ue(null):{},this.size=0}function Ye(m){var O=this.has(m)&&delete this.__data__[m];return this.size-=O?1:0,O}function Ha(m){var O=this.__data__;if(Ue){var F=O[m];return F===i?void 0:F}return te.call(O,m)?O[m]:void 0}function za(m){var O=this.__data__;return Ue?O[m]!==void 0:te.call(O,m)}function Ba(m,O){var F=this.__data__;return this.size+=this.has(m)?0:1,F[m]=Ue&&O===void 0?i:O,this}Ae.prototype.clear=We,Ae.prototype.delete=Ye,Ae.prototype.get=Ha,Ae.prototype.has=za,Ae.prototype.set=Ba;function Tt(m){var O=-1,F=m==null?0:m.length;for(this.clear();++O<F;){var V=m[O];this.set(V[0],V[1])}}function qa(){this.__data__=[],this.size=0}function Ka(m){var O=this.__data__,F=Kr(O,m);if(F<0)return!1;var V=O.length-1;return F==V?O.pop():Ft.call(O,F,1),--this.size,!0}function Va(m){var O=this.__data__,F=Kr(O,m);return F<0?void 0:O[F][1]}function Ga(m){return Kr(this.__data__,m)>-1}function ka(m,O){var F=this.__data__,V=Kr(F,m);return V<0?(++this.size,F.push([m,O])):F[V][1]=O,this}Tt.prototype.clear=qa,Tt.prototype.delete=Ka,Tt.prototype.get=Va,Tt.prototype.has=Ga,Tt.prototype.set=ka;function Kt(m){var O=-1,F=m==null?0:m.length;for(this.clear();++O<F;){var V=m[O];this.set(V[0],V[1])}}function Wa(){this.size=0,this.__data__={hash:new Ae,map:new(Re||Tt),string:new Ae}}function Ya(m){var O=Vr(this,m).delete(m);return this.size-=O?1:0,O}function Ja(m){return Vr(this,m).get(m)}function Xa(m){return Vr(this,m).has(m)}function Za(m,O){var F=Vr(this,m),V=F.size;return F.set(m,O),this.size+=F.size==V?0:1,this}Kt.prototype.clear=Wa,Kt.prototype.delete=Ya,Kt.prototype.get=Ja,Kt.prototype.has=Xa,Kt.prototype.set=Za;function qr(m){var O=-1,F=m==null?0:m.length;for(this.__data__=new Kt;++O<F;)this.add(m[O])}function Qa(m){return this.__data__.set(m,i),this}function ec(m){return this.__data__.has(m)}qr.prototype.add=qr.prototype.push=Qa,qr.prototype.has=ec;function Lt(m){var O=this.__data__=new Tt(m);this.size=O.size}function tc(){this.__data__=new Tt,this.size=0}function rc(m){var O=this.__data__,F=O.delete(m);return this.size=O.size,F}function ic(m){return this.__data__.get(m)}function sc(m){return this.__data__.has(m)}function nc(m,O){var F=this.__data__;if(F instanceof Tt){var V=F.__data__;if(!Re||V.length<r-1)return V.push([m,O]),this.size=++F.size,this;F=this.__data__=new Kt(V)}return F.set(m,O),this.size=F.size,this}Lt.prototype.clear=tc,Lt.prototype.delete=rc,Lt.prototype.get=ic,Lt.prototype.has=sc,Lt.prototype.set=nc;function oc(m,O){var F=Gr(m),V=!F&&Ec(m),Ne=!F&&!V&&_i(m),se=!F&&!V&&!Ne&&Hs(m),Fe=F||V||Ne||se,Je=Fe?Le(m.length,String):[],Ze=Je.length;for(var Ce in m)(O||te.call(m,Ce))&&!(Fe&&(Ce=="length"||Ne&&(Ce=="offset"||Ce=="parent")||se&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||yc(Ce,Ze)))&&Je.push(Ce);return Je}function Kr(m,O){for(var F=m.length;F--;)if(Ls(m[F][0],O))return F;return-1}function ac(m,O,F){var V=O(m);return Gr(m)?V:de(V,F(m))}function pr(m){return m==null?m===void 0?P:U:ct&&ct in Object(m)?gc(m):_c(m)}function Ps(m){return yr(m)&&pr(m)==u}function Rs(m,O,F,V,Ne){return m===O?!0:m==null||O==null||!yr(m)&&!yr(O)?m!==m&&O!==O:cc(m,O,F,V,Rs,Ne)}function cc(m,O,F,V,Ne,se){var Fe=Gr(m),Je=Gr(O),Ze=Fe?f:$t(m),Ce=Je?f:$t(O);Ze=Ze==u?c:Ze,Ce=Ce==u?c:Ce;var ut=Ze==c,bt=Ce==c,tt=Ze==Ce;if(tt&&_i(m)){if(!_i(O))return!1;Fe=!0,ut=!1}if(tt&&!ut)return se||(se=new Lt),Fe||Hs(m)?Us(m,O,F,V,Ne,se):fc(m,O,Ze,F,V,Ne,se);if(!(F&s)){var dt=ut&&te.call(m,"__wrapped__"),gt=bt&&te.call(O,"__wrapped__");if(dt||gt){var Mt=dt?m.value():m,Nt=gt?O.value():O;return se||(se=new Lt),Ne(Mt,Nt,F,V,se)}}return tt?(se||(se=new Lt),dc(m,O,F,V,Ne,se)):!1}function uc(m){if(!js(m)||bc(m))return!1;var O=$s(m)?ve:B;return O.test(Vt(m))}function hc(m){return yr(m)&&Ms(m.length)&&!!k[pr(m)]}function lc(m){if(!wc(m))return Br(m);var O=[];for(var F in Object(m))te.call(m,F)&&F!="constructor"&&O.push(F);return O}function Us(m,O,F,V,Ne,se){var Fe=F&s,Je=m.length,Ze=O.length;if(Je!=Ze&&!(Fe&&Ze>Je))return!1;var Ce=se.get(m);if(Ce&&se.get(O))return Ce==O;var ut=-1,bt=!0,tt=F&a?new qr:void 0;for(se.set(m,O),se.set(O,m);++ut<Je;){var dt=m[ut],gt=O[ut];if(V)var Mt=Fe?V(gt,dt,ut,O,m,se):V(dt,gt,ut,m,O,se);if(Mt!==void 0){if(Mt)continue;bt=!1;break}if(tt){if(!_e(O,function(Nt,Gt){if(!ye(tt,Gt)&&(dt===Nt||Ne(dt,Nt,F,V,se)))return tt.push(Gt)})){bt=!1;break}}else if(!(dt===gt||Ne(dt,gt,F,V,se))){bt=!1;break}}return se.delete(m),se.delete(O),bt}function fc(m,O,F,V,Ne,se,Fe){switch(F){case Y:if(m.byteLength!=O.byteLength||m.byteOffset!=O.byteOffset)return!1;m=m.buffer,O=O.buffer;case W:return!(m.byteLength!=O.byteLength||!se(new mt(m),new mt(O)));case b:case E:case x:return Ls(+m,+O);case N:return m.name==O.name&&m.message==O.message;case l:case n:return m==O+"";case R:var Je=fe;case y:var Ze=V&s;if(Je||(Je=ce),m.size!=O.size&&!Ze)return!1;var Ce=Fe.get(m);if(Ce)return Ce==O;V|=a,Fe.set(m,O);var ut=Us(Je(m),Je(O),V,Ne,se,Fe);return Fe.delete(m),ut;case p:if(ze)return ze.call(m)==ze.call(O)}return!1}function dc(m,O,F,V,Ne,se){var Fe=F&s,Je=Fs(m),Ze=Je.length,Ce=Fs(O),ut=Ce.length;if(Ze!=ut&&!Fe)return!1;for(var bt=Ze;bt--;){var tt=Je[bt];if(!(Fe?tt in O:te.call(O,tt)))return!1}var dt=se.get(m);if(dt&&se.get(O))return dt==O;var gt=!0;se.set(m,O),se.set(O,m);for(var Mt=Fe;++bt<Ze;){tt=Je[bt];var Nt=m[tt],Gt=O[tt];if(V)var zs=Fe?V(Gt,Nt,tt,O,m,se):V(Nt,Gt,tt,m,O,se);if(!(zs===void 0?Nt===Gt||Ne(Nt,Gt,F,V,se):zs)){gt=!1;break}Mt||(Mt=tt=="constructor")}if(gt&&!Mt){var kr=m.constructor,Wr=O.constructor;kr!=Wr&&"constructor"in m&&"constructor"in O&&!(typeof kr=="function"&&kr instanceof kr&&typeof Wr=="function"&&Wr instanceof Wr)&&(gt=!1)}return se.delete(m),se.delete(O),gt}function Fs(m){return ac(m,Sc,pc)}function Vr(m,O){var F=m.__data__;return mc(O)?F[typeof O=="string"?"string":"hash"]:F.map}function rr(m,O){var F=ge(m,O);return uc(F)?F:void 0}function gc(m){var O=te.call(m,ct),F=m[ct];try{m[ct]=void 0;var V=!0}catch{}var Ne=we.call(m);return V&&(O?m[ct]=F:delete m[ct]),Ne}var pc=qt?function(m){return m==null?[]:(m=Object(m),me(qt(m),function(O){return Dt.call(m,O)}))}:Oc,$t=pr;($e&&$t(new $e(new ArrayBuffer(1)))!=Y||Re&&$t(new Re)!=R||Me&&$t(Me.resolve())!=d||je&&$t(new je)!=y||He&&$t(new He)!=j)&&($t=function(m){var O=pr(m),F=O==c?m.constructor:void 0,V=F?Vt(F):"";if(V)switch(V){case qe:return Y;case Ke:return R;case Ve:return d;case Ge:return y;case ke:return j}return O});function yc(m,O){return O=O==null?g:O,!!O&&(typeof m=="number"||Z.test(m))&&m>-1&&m%1==0&&m<O}function mc(m){var O=typeof m;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?m!=="__proto__":m===null}function bc(m){return!!be&&be in m}function wc(m){var O=m&&m.constructor,F=typeof O=="function"&&O.prototype||ee;return m===F}function _c(m){return we.call(m)}function Vt(m){if(m!=null){try{return pe.call(m)}catch{}try{return m+""}catch{}}return""}function Ls(m,O){return m===O||m!==m&&O!==O}var Ec=Ps(function(){return arguments}())?Ps:function(m){return yr(m)&&te.call(m,"callee")&&!Dt.call(m,"callee")},Gr=Array.isArray;function vc(m){return m!=null&&Ms(m.length)&&!$s(m)}var _i=gr||xc;function Dc(m,O){return Rs(m,O)}function $s(m){if(!js(m))return!1;var O=pr(m);return O==v||O==D||O==w||O==h}function Ms(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=g}function js(m){var O=typeof m;return m!=null&&(O=="object"||O=="function")}function yr(m){return m!=null&&typeof m=="object"}var Hs=le?Pe(le):hc;function Sc(m){return vc(m)?oc(m):lc(m)}function Oc(){return[]}function xc(){return!1}t.exports=Dc})(Qi,Qi.exports);const vd=Qi.exports;function Dd(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<t.length;s++){var a=t.charAt(s),g=a.charCodeAt(0);if(r[g]!==255)throw new TypeError(a+" is ambiguous");r[g]=s}var u=t.length,f=t.charAt(0),w=Math.log(u)/Math.log(256),b=Math.log(256)/Math.log(u);function E(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var R=0,x=0,U=0,c=D.length;U!==c&&D[U]===0;)U++,R++;for(var d=(c-U)*b+1>>>0,h=new Uint8Array(d);U!==c;){for(var l=D[U],y=0,n=d-1;(l!==0||y<x)&&n!==-1;n--,y++)l+=256*h[n]>>>0,h[n]=l%u>>>0,l=l/u>>>0;if(l!==0)throw new Error("Non-zero carry");x=y,U++}for(var p=d-x;p!==d&&h[p]===0;)p++;for(var P=f.repeat(R);p<d;++p)P+=t.charAt(h[p]);return P}function N(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var R=0;if(D[R]!==" "){for(var x=0,U=0;D[R]===f;)x++,R++;for(var c=(D.length-R)*w+1>>>0,d=new Uint8Array(c);D[R];){var h=r[D.charCodeAt(R)];if(h===255)return;for(var l=0,y=c-1;(h!==0||l<U)&&y!==-1;y--,l++)h+=u*d[y]>>>0,d[y]=h%256>>>0,h=h/256>>>0;if(h!==0)throw new Error("Non-zero carry");U=l,R++}if(D[R]!==" "){for(var n=c-U;n!==c&&d[n]===0;)n++;for(var p=new Uint8Array(x+(c-n)),P=x;n!==c;)p[P++]=d[n++];return p}}}function v(D){var R=N(D);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:E,decodeUnsafe:N,decode:v}}var Sd=Dd,Od=Sd;const va=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},xd=t=>new TextEncoder().encode(t),Id=t=>new TextDecoder().decode(t);class Td{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Nd{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Da(this,e)}}class Ad{constructor(e){this.decoders=e}or(e){return Da(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Da=(t,e)=>new Ad({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Cd{constructor(e,r,i,s){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new Td(e,r,i),this.decoder=new Nd(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yi=({name:t,prefix:e,encode:r,decode:i})=>new Cd(t,e,r,i),Hr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:s}=Od(r,e);return yi({prefix:t,name:e,encode:i,decode:a=>va(s(a))})},Pd=(t,e,r,i)=>{const s={};for(let b=0;b<e.length;++b)s[e[b]]=b;let a=t.length;for(;t[a-1]==="=";)--a;const g=new Uint8Array(a*r/8|0);let u=0,f=0,w=0;for(let b=0;b<a;++b){const E=s[t[b]];if(E===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|E,u+=r,u>=8&&(u-=8,g[w++]=255&f>>u)}if(u>=r||255&f<<8-u)throw new SyntaxError("Unexpected end of data");return g},Rd=(t,e,r)=>{const i=e[e.length-1]==="=",s=(1<<r)-1;let a="",g=0,u=0;for(let f=0;f<t.length;++f)for(u=u<<8|t[f],g+=8;g>r;)g-=r,a+=e[s&u>>g];if(g&&(a+=e[s&u<<r-g]),i)for(;a.length*r&7;)a+="=";return a},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>yi({prefix:e,name:t,encode(s){return Rd(s,i,r)},decode(s){return Pd(s,i,r,t)}}),Ud=yi({prefix:"\0",name:"identity",encode:t=>Id(t),decode:t=>xd(t)});var Fd=Object.freeze({__proto__:null,identity:Ud});const Ld=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $d=Object.freeze({__proto__:null,base2:Ld});const Md=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var jd=Object.freeze({__proto__:null,base8:Md});const Hd=Hr({prefix:"9",name:"base10",alphabet:"0123456789"});var zd=Object.freeze({__proto__:null,base10:Hd});const Bd=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qd=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Kd=Object.freeze({__proto__:null,base16:Bd,base16upper:qd});const Vd=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gd=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kd=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Wd=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yd=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jd=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xd=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zd=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qd=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var eg=Object.freeze({__proto__:null,base32:Vd,base32upper:Gd,base32pad:kd,base32padupper:Wd,base32hex:Yd,base32hexupper:Jd,base32hexpad:Xd,base32hexpadupper:Zd,base32z:Qd});const tg=Hr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rg=Hr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ig=Object.freeze({__proto__:null,base36:tg,base36upper:rg});const sg=Hr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ng=Hr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var og=Object.freeze({__proto__:null,base58btc:sg,base58flickr:ng});const ag=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),cg=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ug=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),hg=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var lg=Object.freeze({__proto__:null,base64:ag,base64pad:cg,base64url:ug,base64urlpad:hg});const Sa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),fg=Sa.reduce((t,e,r)=>(t[r]=e,t),[]),dg=Sa.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function gg(t){return t.reduce((e,r)=>(e+=fg[r],e),"")}function pg(t){const e=[];for(const r of t){const i=dg[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const yg=yi({prefix:"\u{1F680}",name:"base256emoji",encode:gg,decode:pg});var mg=Object.freeze({__proto__:null,base256emoji:yg}),bg=Oa,qn=128,wg=127,_g=~wg,Eg=Math.pow(2,31);function Oa(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Eg;)e[r++]=t&255|qn,t/=128;for(;t&_g;)e[r++]=t&255|qn,t>>>=7;return e[r]=t|0,Oa.bytes=r-i+1,e}var vg=es,Dg=128,Kn=127;function es(t,i){var r=0,i=i||0,s=0,a=i,g,u=t.length;do{if(a>=u)throw es.bytes=0,new RangeError("Could not decode varint");g=t[a++],r+=s<28?(g&Kn)<<s:(g&Kn)*Math.pow(2,s),s+=7}while(g>=Dg);return es.bytes=a-i,r}var Sg=Math.pow(2,7),Og=Math.pow(2,14),xg=Math.pow(2,21),Ig=Math.pow(2,28),Tg=Math.pow(2,35),Ng=Math.pow(2,42),Ag=Math.pow(2,49),Cg=Math.pow(2,56),Pg=Math.pow(2,63),Rg=function(t){return t<Sg?1:t<Og?2:t<xg?3:t<Ig?4:t<Tg?5:t<Ng?6:t<Ag?7:t<Cg?8:t<Pg?9:10},Ug={encode:bg,decode:vg,encodingLength:Rg},xa=Ug;const Vn=(t,e,r=0)=>(xa.encode(t,e,r),e),Gn=t=>xa.encodingLength(t),ts=(t,e)=>{const r=e.byteLength,i=Gn(t),s=i+Gn(r),a=new Uint8Array(s+r);return Vn(t,a,0),Vn(r,a,i),a.set(e,s),new Fg(t,r,e,a)};class Fg{constructor(e,r,i,s){this.code=e,this.size=r,this.digest=i,this.bytes=s}}const Ia=({name:t,code:e,encode:r})=>new Lg(t,e,r);class Lg{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ts(this.code,r):r.then(i=>ts(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Ta=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),$g=Ia({name:"sha2-256",code:18,encode:Ta("SHA-256")}),Mg=Ia({name:"sha2-512",code:19,encode:Ta("SHA-512")});var jg=Object.freeze({__proto__:null,sha256:$g,sha512:Mg});const Na=0,Hg="identity",Aa=va,zg=t=>ts(Na,Aa(t)),Bg={code:Na,name:Hg,encode:Aa,digest:zg};var qg=Object.freeze({__proto__:null,identity:Bg});new TextEncoder,new TextDecoder;const kn={...Fd,...$d,...jd,...zd,...Kd,...eg,...ig,...og,...lg,...mg};({...jg,...qg});function Kg(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ca(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Wn=Ca("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ui=Ca("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Kg(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Vg={utf8:Wn,"utf-8":Wn,hex:kn.base16,latin1:Ui,ascii:Ui,binary:Ui,...kn};function Gg(t,e="utf8"){const r=Vg[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Pa="wc",kg=2,Ds="core",Ht=`${Pa}@${2}:${Ds}:`,Wg={name:Ds,logger:"error"},Yg={database:":memory:"},Jg="crypto",Yn="client_ed25519_seed",Xg=J.ONE_DAY,Zg="keychain",Qg="0.3",ep="messages",tp="0.3",rp=J.SIX_HOURS,ip="publisher",Ra="irn",sp="error",np="wss://relay.walletconnect.com",op="relayer",it={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ap="_subscription",Jr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Jn=J.ONE_SECOND,cp="2.3.2",up="0.3",xt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},hp="subscription",lp="0.3",fp=J.FIVE_SECONDS*1e3,dp="pairing",gp="0.3",Sr={wc_pairingDelete:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:J.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:J.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:J.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:J.ONE_DAY,prompt:!1,tag:0},res:{ttl:J.ONE_DAY,prompt:!1,tag:0}}},Ot={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},pp="history",yp="0.3",mp="expirer",pt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},bp="0.3";class wp{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Zg,this.version=Qg,this.initialized=!1,this.storagePrefix=Ht,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,s)=>{this.isInitialized(),this.keychain.set(i,s),await this.persist()},this.get=i=>{this.isInitialized();const s=this.keychain.get(i);if(typeof s>"u"){const{message:a}=Te("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(a)}return s},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,la(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?fa(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class _p{constructor(e,r,i){this.core=e,this.logger=r,this.name=Jg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),a=wn(s);return Jo(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=pf();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const a=await this.getClientSeed(),g=wn(a),u=Yi();return await Tl(u,s,Xg,g)},this.generateSharedKey=(s,a,g)=>{this.isInitialized();const u=this.getPrivateKey(s),f=yf(u,a);return this.setSymKey(f,g)},this.setSymKey=async(s,a)=>{this.isInitialized();const g=a||mf(s);return await this.keychain.set(g,s),g},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,a,g)=>{this.isInitialized();const u=ua(g),f=Cr(a);if(An(u)){const N=u.senderPublicKey,v=u.receiverPublicKey;s=await this.generateSharedKey(N,v)}const w=this.getSymKey(s),{type:b,senderPublicKey:E}=u;return wf({type:b,symKey:w,message:f,senderPublicKey:E})},this.decode=async(s,a,g)=>{this.isInitialized();const u=vf(a,g);if(An(u)){const b=u.receiverPublicKey,E=u.senderPublicKey;s=await this.generateSharedKey(b,E)}const f=this.getSymKey(s),w=_f({symKey:f,encoded:a});return ns(w)},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=i||new wp(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const r=bs(e);return Mr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Yn)}catch{e=Yi(),await this.keychain.set(Yn,e)}return Gg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ep extends du{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=ep,this.version=tp,this.initialized=!1,this.storagePrefix=Ht,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,s)=>{this.isInitialized();const a=Ji(s);let g=this.messages.get(i);return typeof g>"u"&&(g={}),typeof g[a]<"u"||(g[a]=s,this.messages.set(i,g),await this.persist()),a},this.get=i=>{this.isInitialized();let s=this.messages.get(i);return typeof s>"u"&&(s={}),s},this.has=(i,s)=>{this.isInitialized();const a=this.get(i),g=Ji(s);return typeof a[g]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,la(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?fa(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class vp extends gu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new at.exports.EventEmitter,this.name=ip,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,s,a)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:a}});try{const g=(a==null?void 0:a.ttl)||rp,u=Xi(a),f=(a==null?void 0:a.prompt)||!1,w=(a==null?void 0:a.tag)||0,b={topic:i,message:s,opts:{ttl:g,relay:u,prompt:f,tag:w}},E=Ji(s);this.queue.set(E,b);try{await await da(this.rpcPublish(i,s,g,u,f,w),this.publishTimeout),this.relayer.events.emit(it.publish,b)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(it.connection_stalled);return}this.onPublish(E,b),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:a}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,i,s,a,g){var u,f,w,b;const E={method:Zi(s.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:a,tag:g}};return si((u=E.params)==null?void 0:u.prompt)&&((f=E.params)==null||delete f.prompt),si((w=E.params)==null?void 0:w.tag)&&((b=E.params)==null||delete b.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:E}),this.relayer.provider.request(E)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:s}=e;await this.publish(r,i,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class Dp{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const s=i.filter(a=>a!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Sp=Object.defineProperty,Op=Object.defineProperties,xp=Object.getOwnPropertyDescriptors,Xn=Object.getOwnPropertySymbols,Ip=Object.prototype.hasOwnProperty,Tp=Object.prototype.propertyIsEnumerable,Zn=(t,e,r)=>e in t?Sp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xr=(t,e)=>{for(var r in e||(e={}))Ip.call(e,r)&&Zn(t,r,e[r]);if(Xn)for(var r of Xn(e))Tp.call(e,r)&&Zn(t,r,e[r]);return t},Fi=(t,e)=>Op(t,xp(e));class Np extends mu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new Dp,this.events=new at.exports.EventEmitter,this.name=hp,this.version=lp,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Ht,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}});try{const a=Xi(s),g={topic:i,relay:a};this.pending.set(i,g);const u=await this.rpcSubscribe(i,a);return this.onSubscribe(u,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}}),u}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(i,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(i,s.id,s):await this.unsubscribeByTopic(i,s)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((s,a)=>{const g=new J.Watch;g.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(u),g.stop(this.pendingSubscriptionWatchLabel),s(!0)),g.elapsed(this.pendingSubscriptionWatchLabel)>=fp&&(clearInterval(u),g.stop(this.pendingSubscriptionWatchLabel),a(!1))},this.pendingSubInterval)}),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const s=Xi(i);await this.rpcUnsubscribe(e,r,s);const a=Ir("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r){const i={method:Zi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let s;try{s=await await da(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(it.connection_stalled)}return s}rpcUnsubscribe(e,r,i){const s={method:Zi(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.provider.request(s)}onSubscribe(e,r){this.setSubscription(e,Fi(Xr({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Fi(Xr({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Xr({},r)),this.topicMap.set(r.topic,e),this.events.emit(xt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(xt.deleted,Fi(Xr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(xt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(xt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,s={topic:r,relay:i};this.pending.set(s.topic,s);const a=await this.rpcSubscribe(s.topic,s.relay);this.onResubscribe(a,s)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(it.connect,async()=>{await this.onConnect()}),this.relayer.on(it.disconnect,()=>{this.onDisconnect()}),this.events.on(xt.created,async e=>{const r=xt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(xt.deleted,async e=>{const r=xt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Ap=Object.defineProperty,Qn=Object.getOwnPropertySymbols,Cp=Object.prototype.hasOwnProperty,Pp=Object.prototype.propertyIsEnumerable,eo=(t,e,r)=>e in t?Ap(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rp=(t,e)=>{for(var r in e||(e={}))Cp.call(e,r)&&eo(t,r,e[r]);if(Qn)for(var r of Qn(e))Pp.call(e,r)&&eo(t,r,e[r]);return t};class Up extends pu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new at.exports.EventEmitter,this.name=op,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Rr(Se.getDefaultLoggerOptions({level:e.logger||sp})),this.messages=new Ep(this.logger,e.core),this.subscriber=new Np(this,this.logger),this.publisher=new vp(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||np,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(s=>{this.subscriber.once(xt.created,a=>{a.topic===e&&s()})}),new Promise(async s=>{i=await this.subscriber.subscribe(e,r),s()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(it.transport_closed))}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(xt.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,i)=>this.once(it.transport_closed,()=>{i(new Error("closeTransport called before connection was established"))}))])])}catch(r){const i=r;if(!/socket hang up/i.test(i.message))throw new Error(i.message);this.logger.error(i),this.events.emit(it.transport_closed)}}async restartTransport(e){await this.transportClose(),await new Promise(r=>setTimeout(r,Jn)),await this.transportOpen(e)}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new jr(new Ed(Ff({sdkVersion:cp,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Es(e)){if(!e.method.endsWith(ap))return;const r=e.params,{topic:i,message:s}=r.data,a={topic:i,message:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Rp({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(it.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=_s(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(Jr.payload,e=>this.onProviderPayload(e)),this.provider.on(Jr.connect,()=>{this.events.emit(it.connect)}),this.provider.on(Jr.disconnect,()=>{this.events.emit(it.disconnect),this.attemptToReconnect()}),this.provider.on(Jr.error,e=>this.events.emit(it.error,e)),this.events.on(it.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},J.toMiliseconds(Jn))}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Fp=Object.defineProperty,to=Object.getOwnPropertySymbols,Lp=Object.prototype.hasOwnProperty,$p=Object.prototype.propertyIsEnumerable,ro=(t,e,r)=>e in t?Fp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,io=(t,e)=>{for(var r in e||(e={}))Lp.call(e,r)&&ro(t,r,e[r]);if(to)for(var r of to(e))$p.call(e,r)&&ro(t,r,e[r]);return t};class mi extends yu{constructor(e,r,i,s=Ht,a=void 0){super(e,r,i,s),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=up,this.cached=[],this.initialized=!1,this.storagePrefix=Ht,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{Zf(g)?this.map.set(g.id,g):Qf(g)?this.map.set(g.topic,g):this.getKey&&g!==null&&!si(g)&&this.map.set(this.getKey(g),g)}),this.cached=[],this.initialized=!0)},this.set=async(g,u)=>{this.isInitialized(),this.map.has(g)?await this.update(g,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:u}),this.map.set(g,u),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(u=>Object.keys(g).every(f=>vd(u[f],g[f]))):this.values),this.update=async(g,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:u});const f=io(io({},this.getData(g)),u);this.map.set(g,f),await this.persist()},this.delete=async(g,u)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:u}),this.map.delete(g),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=s,this.getKey=a}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Mp{constructor(e,r){this.core=e,this.logger=r,this.name=dp,this.version=gp,this.events=new at.exports,this.initialized=!1,this.storagePrefix=Ht,this.ignoredPayloadTypes=[lr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Yi(),s=await this.core.crypto.setSymKey(i),a=Ci(J.FIVE_MINUTES),g={protocol:Ra},u={topic:s,expiry:a,relay:g,active:!1},f=Wf({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:g});return await this.pairings.set(s,u),await this.core.relayer.subscribe(s),this.core.expirer.set(s,a),{topic:s,uri:f}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:s,symKey:a,relay:g}=Gf(i.uri),u=Ci(J.FIVE_MINUTES),f={topic:s,relay:g,expiry:u,active:!1};return await this.pairings.set(s,f),await this.core.crypto.setSymKey(a,s),await this.core.relayer.subscribe(s,{relay:g}),this.core.expirer.set(s,u),i.activatePairing&&await this.activate({topic:s}),f},this.activate=async({topic:i})=>{this.isInitialized();const s=Ci(J.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:s}),this.core.expirer.set(i,s)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.pairings.keys.includes(s)){const a=await this.sendRequest(s,"wc_pairingPing",{}),{done:g,resolve:u,reject:f}=Lf();this.events.once(Pi("pairing_ping",a),({error:w})=>{w?f(w):u()}),await g()}},this.updateExpiry=async({topic:i,expiry:s})=>{this.isInitialized(),await this.pairings.update(i,{expiry:s})},this.updateMetadata=async({topic:i,metadata:s})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Ir("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(i,s,a)=>{const g=gi(s,a),u=await this.core.crypto.encode(i,g),f=Sr[s].req;return this.core.history.set(i,g),await this.core.relayer.publish(i,u,f),g.id},this.sendResult=async(i,s,a)=>{const g=_s(i,a),u=await this.core.crypto.encode(s,g),f=await this.core.history.get(s,i),w=Sr[f.request.method].res;await this.core.relayer.publish(s,u,w),await this.core.history.resolve(g)},this.sendError=async(i,s,a)=>{const g=pi(i,a),u=await this.core.crypto.encode(s,g),f=await this.core.history.get(s,i),w=Sr[f.request.method]?Sr[f.request.method].res:Sr.unregistered_method.res;await this.core.relayer.publish(s,u,w),await this.core.history.resolve(g)},this.deletePairing=async(i,s)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ir("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),s?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(s=>Un(s.expiry));await Promise.all(i.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=i=>{const{topic:s,payload:a}=i,g=a.method;if(this.pairings.keys.includes(s))switch(g){case"wc_pairingPing":return this.onPairingPingRequest(s,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,a);default:return this.onUnknownRpcMethodRequest(s,a)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:a}=i,g=(await this.core.history.get(s,a.id)).request.method;if(this.pairings.keys.includes(s))switch(g){case"wc_pairingPing":return this.onPairingPingResponse(s,a);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(i,s)=>{const{id:a}=s;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.events.emit("pairing_ping",{id:a,topic:i})}catch(g){await this.sendError(a,i,g),this.logger.error(g)}},this.onPairingPingResponse=(i,s)=>{const{id:a}=s;setTimeout(()=>{Rt(s)?this.events.emit(Pi("pairing_ping",a),{}):_t(s)&&this.events.emit(Pi("pairing_ping",a),{error:s.error})},500)},this.onPairingDeleteRequest=async(i,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:i}),await this.sendResult(a,i,!0),await this.deletePairing(i),this.events.emit("pairing_delete",{id:a,topic:i})}catch(g){await this.sendError(a,i,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(i,s)=>{const{id:a,method:g}=s;try{if(this.registeredMethods.includes(g))return;const u=Ir("WC_METHOD_UNSUPPORTED",g);await this.sendError(a,i,u),this.logger.error(u)}catch(u){await this.sendError(a,i,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ir("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!Ri(i)){const{message:s}=Te("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(s)}if(!Xf(i.uri)){const{message:s}=Te("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(s)}},this.isValidPing=async i=>{if(!Ri(i)){const{message:a}=Te("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidDisconnect=async i=>{if(!Ri(i)){const{message:a}=Te("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async i=>{if(!pa(i,!1)){const{message:s}=Te("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(s)}if(!this.pairings.keys.includes(i)){const{message:s}=Te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(s)}if(Un(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:s}=Te("EXPIRED",`pairing topic: ${i}`);throw new Error(s)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new mi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(it.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(r,i);Es(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):vs(s)&&(await this.core.history.resolve(s),this.onRelayEventResponse({topic:r,payload:s}))})}registerExpirerEvents(){this.core.expirer.on(pt.expired,async e=>{const{topic:r}=jf(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class jp extends fu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new at.exports.EventEmitter,this.name=pp,this.version=yp,this.cached=[],this.initialized=!1,this.storagePrefix=Ht,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,s,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:s,chainId:a}),this.records.has(s.id))return;const g={id:s.id,topic:i,request:{method:s.method,params:s.params||null},chainId:a};this.records.set(g.id,g),this.events.emit(Ot.created,g)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const s=await this.getRecord(i.id);typeof s.response>"u"&&(s.response=_t(i)?{error:i.error}:{result:i.result},this.records.set(s.id,s),this.events.emit(Ot.updated,s))},this.get=async(i,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:s}),await this.getRecord(s)),this.delete=(i,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(a=>{if(a.topic===i){if(typeof s<"u"&&a.id!==s)return;this.records.delete(a.id),this.events.emit(Ot.deleted,a)}})},this.exists=async(i,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===i:!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:gi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ot.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ot.created,e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ot.updated,e=>{const r=Ot.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ot.deleted,e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Hp extends bu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new at.exports.EventEmitter,this.name=mp,this.version=bp,this.cached=[],this.initialized=!1,this.storagePrefix=Ht,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const s=this.formatTarget(i);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(i,s)=>{this.isInitialized();const a=this.formatTarget(i),g={target:a,expiry:s};this.expirations.set(a,g),this.checkExpiry(a,g),this.events.emit(pt.created,{target:a,expiration:g})},this.get=i=>{this.isInitialized();const s=this.formatTarget(i);return this.getExpiration(s)},this.del=i=>{if(this.isInitialized(),this.has(i)){const s=this.formatTarget(i),a=this.getExpiration(s);this.expirations.delete(s),this.events.emit(pt.deleted,{target:s,expiration:a})}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return $f(e);if(typeof e=="number")return Mf(e);const{message:r}=Te("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(pt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=Te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;J.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(pt.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Fr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(pt.created,e=>{const r=pt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(pt.expired,e=>{const r=pt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(pt.deleted,e=>{const r=pt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var zp=Object.defineProperty,so=Object.getOwnPropertySymbols,Bp=Object.prototype.hasOwnProperty,qp=Object.prototype.propertyIsEnumerable,no=(t,e,r)=>e in t?zp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,oo=(t,e)=>{for(var r in e||(e={}))Bp.call(e,r)&&no(t,r,e[r]);if(so)for(var r of so(e))qp.call(e,r)&&no(t,r,e[r]);return t};class Ss extends lu{constructor(e){super(e),this.protocol=Pa,this.version=kg,this.name=Ds,this.events=new at.exports.EventEmitter,this.initialized=!1,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.projectId=e==null?void 0:e.projectId;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Rr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Wg.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new Fr.HeartBeat,this.crypto=new _p(this,this.logger,e==null?void 0:e.keychain),this.history=new jp(this,this.logger),this.expirer=new Hp(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Jc(oo(oo({},Yg),e==null?void 0:e.storageOptions)),this.relayer=new Up({core:this,logger:this.logger,relayUrl:e==null?void 0:e.relayUrl,projectId:this.projectId}),this.pairing=new Mp(this,this.logger)}static async init(e){const r=new Ss(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Kp=Ss;class Vp{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Gp{constructor(e){this.client=e}}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=xe.getLocation=xe.getLocationOrThrow=xe.getNavigator=xe.getNavigatorOrThrow=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function er(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}xe.getFromWindow=er;function fr(t){const e=er(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}xe.getFromWindowOrThrow=fr;function kp(){return fr("document")}xe.getDocumentOrThrow=kp;function Wp(){return er("document")}xe.getDocument=Wp;function Yp(){return fr("navigator")}xe.getNavigatorOrThrow=Yp;function Jp(){return er("navigator")}xe.getNavigator=Jp;function Xp(){return fr("location")}xe.getLocationOrThrow=Xp;function Zp(){return er("location")}xe.getLocation=Zp;function Qp(){return fr("crypto")}xe.getCryptoOrThrow=Qp;function e0(){return er("crypto")}xe.getCrypto=e0;function t0(){return fr("localStorage")}xe.getLocalStorageOrThrow=t0;function r0(){return er("localStorage")}xe.getLocalStorage=r0;var Os={};Object.defineProperty(Os,"__esModule",{value:!0});var Ua=Os.getWindowMetadata=void 0;const ao=xe;function i0(){let t,e;try{t=ao.getDocumentOrThrow(),e=ao.getLocationOrThrow()}catch{return null}function r(){const E=t.getElementsByTagName("link"),N=[];for(let v=0;v<E.length;v++){const D=E[v],R=D.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const x=D.getAttribute("href");if(x)if(x.toLowerCase().indexOf("https:")===-1&&x.toLowerCase().indexOf("http:")===-1&&x.indexOf("//")!==0){let U=e.protocol+"//"+e.host;if(x.indexOf("/")===0)U+=x;else{const c=e.pathname.split("/");c.pop();const d=c.join("/");U+=d+"/"+x}N.push(U)}else if(x.indexOf("//")===0){const U=e.protocol+x;N.push(U)}else N.push(x)}}return N}function i(...E){const N=t.getElementsByTagName("meta");for(let v=0;v<N.length;v++){const D=N[v],R=["itemprop","property","name"].map(x=>D.getAttribute(x)).filter(x=>x?E.includes(x):!1);if(R.length&&R){const x=D.getAttribute("content");if(x)return x}}return""}function s(){let E=i("name","og:site_name","og:title","twitter:title");return E||(E=t.title),E}function a(){return i("description","og:description","twitter:description","keywords")}const g=s(),u=a(),f=e.origin,w=r();return{description:u,url:f,icons:w,name:g}}Ua=Os.getWindowMetadata=i0;var s0={};(function(t){const e=is,r=ss,i=rs,s=ps,a=c=>c==null,g=Symbol("encodeFragmentIdentifier");function u(c){switch(c.arrayFormat){case"index":return d=>(h,l)=>{const y=h.length;return l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),"[",y,"]"].join("")]:[...h,[b(d,c),"[",b(y,c),"]=",b(l,c)].join("")]};case"bracket":return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),"[]"].join("")]:[...h,[b(d,c),"[]=",b(l,c)].join("")];case"colon-list-separator":return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),":list="].join("")]:[...h,[b(d,c),":list=",b(l,c)].join("")];case"comma":case"separator":case"bracket-separator":{const d=c.arrayFormat==="bracket-separator"?"[]=":"=";return h=>(l,y)=>y===void 0||c.skipNull&&y===null||c.skipEmptyString&&y===""?l:(y=y===null?"":y,l.length===0?[[b(h,c),d,b(y,c)].join("")]:[[l,b(y,c)].join(c.arrayFormatSeparator)])}default:return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,b(d,c)]:[...h,[b(d,c),"=",b(l,c)].join("")]}}function f(c){let d;switch(c.arrayFormat){case"index":return(h,l,y)=>{if(d=/\[(\d*)\]$/.exec(h),h=h.replace(/\[\d*\]$/,""),!d){y[h]=l;return}y[h]===void 0&&(y[h]={}),y[h][d[1]]=l};case"bracket":return(h,l,y)=>{if(d=/(\[\])$/.exec(h),h=h.replace(/\[\]$/,""),!d){y[h]=l;return}if(y[h]===void 0){y[h]=[l];return}y[h]=[].concat(y[h],l)};case"colon-list-separator":return(h,l,y)=>{if(d=/(:list)$/.exec(h),h=h.replace(/:list$/,""),!d){y[h]=l;return}if(y[h]===void 0){y[h]=[l];return}y[h]=[].concat(y[h],l)};case"comma":case"separator":return(h,l,y)=>{const n=typeof l=="string"&&l.includes(c.arrayFormatSeparator),p=typeof l=="string"&&!n&&E(l,c).includes(c.arrayFormatSeparator);l=p?E(l,c):l;const P=n||p?l.split(c.arrayFormatSeparator).map(j=>E(j,c)):l===null?l:E(l,c);y[h]=P};case"bracket-separator":return(h,l,y)=>{const n=/(\[\])$/.test(h);if(h=h.replace(/\[\]$/,""),!n){y[h]=l&&E(l,c);return}const p=l===null?[]:l.split(c.arrayFormatSeparator).map(P=>E(P,c));if(y[h]===void 0){y[h]=p;return}y[h]=[].concat(y[h],p)};default:return(h,l,y)=>{if(y[h]===void 0){y[h]=l;return}y[h]=[].concat(y[h],l)}}}function w(c){if(typeof c!="string"||c.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(c,d){return d.encode?d.strict?e(c):encodeURIComponent(c):c}function E(c,d){return d.decode?r(c):c}function N(c){return Array.isArray(c)?c.sort():typeof c=="object"?N(Object.keys(c)).sort((d,h)=>Number(d)-Number(h)).map(d=>c[d]):c}function v(c){const d=c.indexOf("#");return d!==-1&&(c=c.slice(0,d)),c}function D(c){let d="";const h=c.indexOf("#");return h!==-1&&(d=c.slice(h)),d}function R(c){c=v(c);const d=c.indexOf("?");return d===-1?"":c.slice(d+1)}function x(c,d){return d.parseNumbers&&!Number.isNaN(Number(c))&&typeof c=="string"&&c.trim()!==""?c=Number(c):d.parseBooleans&&c!==null&&(c.toLowerCase()==="true"||c.toLowerCase()==="false")&&(c=c.toLowerCase()==="true"),c}function U(c,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),w(d.arrayFormatSeparator);const h=f(d),l=Object.create(null);if(typeof c!="string"||(c=c.trim().replace(/^[?#&]/,""),!c))return l;for(const y of c.split("&")){if(y==="")continue;let[n,p]=i(d.decode?y.replace(/\+/g," "):y,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?p:E(p,d),h(E(n,d),p,l)}for(const y of Object.keys(l)){const n=l[y];if(typeof n=="object"&&n!==null)for(const p of Object.keys(n))n[p]=x(n[p],d);else l[y]=x(n,d)}return d.sort===!1?l:(d.sort===!0?Object.keys(l).sort():Object.keys(l).sort(d.sort)).reduce((y,n)=>{const p=l[n];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?y[n]=N(p):y[n]=p,y},Object.create(null))}t.extract=R,t.parse=U,t.stringify=(c,d)=>{if(!c)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),w(d.arrayFormatSeparator);const h=p=>d.skipNull&&a(c[p])||d.skipEmptyString&&c[p]==="",l=u(d),y={};for(const p of Object.keys(c))h(p)||(y[p]=c[p]);const n=Object.keys(y);return d.sort!==!1&&n.sort(d.sort),n.map(p=>{const P=c[p];return P===void 0?"":P===null?b(p,d):Array.isArray(P)?P.length===0&&d.arrayFormat==="bracket-separator"?b(p,d)+"[]":P.reduce(l(p),[]).join("&"):b(p,d)+"="+b(P,d)}).filter(p=>p.length>0).join("&")},t.parseUrl=(c,d)=>{d=Object.assign({decode:!0},d);const[h,l]=i(c,"#");return Object.assign({url:h.split("?")[0]||"",query:U(R(c),d)},d&&d.parseFragmentIdentifier&&l?{fragmentIdentifier:E(l,d)}:{})},t.stringifyUrl=(c,d)=>{d=Object.assign({encode:!0,strict:!0,[g]:!0},d);const h=v(c.url).split("?")[0]||"",l=t.extract(c.url),y=t.parse(l,{sort:!1}),n=Object.assign(y,c.query);let p=t.stringify(n,d);p&&(p=`?${p}`);let P=D(c.url);return c.fragmentIdentifier&&(P=`#${d[g]?b(c.fragmentIdentifier,d):c.fragmentIdentifier}`),`${h}${p}${P}`},t.pick=(c,d,h)=>{h=Object.assign({parseFragmentIdentifier:!0,[g]:!1},h);const{url:l,query:y,fragmentIdentifier:n}=t.parseUrl(c,h);return t.stringifyUrl({url:l,query:s(y,d),fragmentIdentifier:n},h)},t.exclude=(c,d,h)=>{const l=Array.isArray(d)?y=>!d.includes(y):(y,n)=>!d(y,n);return t.pick(c,l,h)}})(s0);const n0=1;function o0(){return Ua()||{name:"",description:"",url:"",icons:[""]}}function jt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Xt(t,e){return J.fromMiliseconds((e||Date.now())+J.toMiliseconds(t))}function or(t){return J.fromMiliseconds(Date.now())>=J.toMiliseconds(t)}function ar(t){const e=J.toMiliseconds(t||J.FIVE_MINUTES);let r,i,s;return{resolve:a=>{s&&r&&(clearTimeout(s),r(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,g)=>{s=setTimeout(g,e),r=a,i=g})}}function a0(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Xe(t,e){return`${t}${e?`:${e}`:""}`}function zr(t){const e=[];return t.forEach(r=>{const[i,s]=r.split(":");e.push(`${i}:${s}`)}),e}function c0(t){const e=[];return Object.values(t).forEach(r=>{e.push(...zr(r.accounts))}),e}function u0(t,e){const r=[];return Object.values(t).forEach(i=>{zr(i.accounts).includes(e)&&r.push(...i.methods)}),r}function h0(t,e){const r=[];return Object.values(t).forEach(i=>{zr(i.accounts).includes(e)&&r.push(...i.events)}),r}function l0(t,e){const r=Qr(t,e);if(r)throw new Error(r.message);const i={};for(const[s,a]of Object.entries(t))i[s]={methods:a.methods,events:a.events,chains:a.accounts.map(g=>`${g.split(":")[0]}:${g.split(":")[1]}`)};return i}const f0={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},d0={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Q(t,e){const{message:r,code:i}=d0[t];return{message:e?`${r} ${e}`:r,code:i}}function ht(t,e){const{message:r,code:i}=f0[t];return{message:e?`${r} ${e}`:r,code:i}}function bi(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function ni(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Ut(t){return typeof t>"u"}function nt(t,e){return e&&Ut(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function xs(t,e){return e&&Ut(t)?!0:typeof t=="number"&&!isNaN(t)}function g0(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),s=Object.keys(r);let a=!0;return jt(s,i)?(i.forEach(g=>{const{accounts:u,methods:f,events:w}=t.namespaces[g],b=zr(u),E=r[g];(!jt(E.chains,b)||!jt(E.methods,f)||!jt(E.events,w))&&(a=!1)}),a):!1}function Is(t){return nt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function p0(t){if(nt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Is(r)}}return!1}function y0(t,e){let r=null;return nt(t==null?void 0:t.publicKey,!1)||(r=Q("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function co(t){let e=!0;return bi(t)?t.length&&(e=t.every(r=>nt(r,!1))):e=!1,e}function m0(t,e,r){let i=null;return bi(e)?e.forEach(s=>{i||(!Is(s)||!s.includes(t))&&(i=ht("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):i=ht("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function b0(t,e){let r=null;return Object.entries(t).forEach(([i,s])=>{if(r)return;const a=m0(i,s==null?void 0:s.chains,`${e} requiredNamespace`);a&&(r=a)}),r}function w0(t,e){let r=null;return bi(t)?t.forEach(i=>{r||p0(i)||(r=ht("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=ht("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function _0(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const s=w0(i==null?void 0:i.accounts,`${e} namespace`);s&&(r=s)}),r}function E0(t,e){let r=null;return co(t==null?void 0:t.methods)?co(t==null?void 0:t.events)||(r=ht("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=ht("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Fa(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const s=E0(i,`${e}, namespace`);s&&(r=s)}),r}function v0(t,e){let r=null;if(t&&ni(t)){const i=Fa(t,e);i&&(r=i);const s=b0(t,e);s&&(r=s)}else r=Q("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function Qr(t,e){let r=null;if(t&&ni(t)){const i=Fa(t,e);i&&(r=i);const s=_0(t,e);s&&(r=s)}else r=Q("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function La(t){return nt(t.protocol,!0)}function D0(t,e){let r=!1;return e&&!t?r=!0:t&&bi(t)&&t.length&&t.forEach(i=>{r=La(i)}),r}function S0(t){return typeof t=="number"}function wt(t){return typeof t<"u"&&typeof t!==null}function O0(t){return!(!t||typeof t!="object"||!t.code||!xs(t.code,!1)||!t.message||!nt(t.message,!1))}function x0(t){return!(Ut(t)||!nt(t.method,!1))}function I0(t){return!(Ut(t)||Ut(t.result)&&Ut(t.error)||!xs(t.id,!1)||!nt(t.jsonrpc,!1))}function T0(t){return!(Ut(t)||!nt(t.name,!1))}function uo(t,e){return!(!Is(e)||!c0(t).includes(e))}function N0(t,e,r){return nt(r,!1)?u0(t,e).includes(r):!1}function A0(t,e,r){return nt(r,!1)?h0(t,e).includes(r):!1}function ho(t,e,r){let i=null;const s=Object.keys(t),a=Object.keys(e);return jt(s,a)?s.forEach(g=>{if(i)return;const u=t[g].chains,f=zr(e[g].accounts);jt(u,f)?jt(t[g].methods,e[g].methods)?jt(t[g].events,e[g].events)||(i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${g}`)):i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${g}`):i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${g}`)}):i=Q("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),i}function C0(t,e){return xs(t,!1)&&t<=e.max&&t>=e.min}const $a="wc",Ma=2,ja="client",Ts=`${$a}@${Ma}:${ja}:`,Li={name:ja,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},P0="proposal",R0="session",Zr=J.SEVEN_DAYS,U0="engine",Or={wc_sessionPropose:{req:{ttl:J.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1104},res:{ttl:J.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1106},res:{ttl:J.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:J.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:J.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1112},res:{ttl:J.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:J.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:J.THIRTY_SECONDS,prompt:!1,tag:1115}}},$i={min:J.FIVE_MINUTES,max:J.SEVEN_DAYS},F0="request";var L0=Object.defineProperty,$0=Object.defineProperties,M0=Object.getOwnPropertyDescriptors,lo=Object.getOwnPropertySymbols,j0=Object.prototype.hasOwnProperty,H0=Object.prototype.propertyIsEnumerable,fo=(t,e,r)=>e in t?L0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pt=(t,e)=>{for(var r in e||(e={}))j0.call(e,r)&&fo(t,r,e[r]);if(lo)for(var r of lo(e))H0.call(e,r)&&fo(t,r,e[r]);return t},Mi=(t,e)=>$0(t,M0(e));class z0 extends Gp{constructor(e){super(e),this.name=U0,this.events=new at.exports,this.initialized=!1,this.ignoredPayloadTypes=[n0],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Or)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:i,requiredNamespaces:s,relays:a}=r;let g=i,u,f=!1;if(g&&(f=this.client.core.pairing.pairings.get(g).active),!g||!f){const{topic:x,uri:U}=await this.client.core.pairing.create();g=x,u=U}const w=await this.client.core.crypto.generateKeyPair(),b={requiredNamespaces:s,relays:a!=null?a:[{protocol:Ra}],proposer:{publicKey:w,metadata:this.client.metadata}},{reject:E,resolve:N,done:v}=ar();if(this.events.once(Xe("session_connect"),async({error:x,session:U})=>{if(x)E(x);else if(U){U.self.publicKey=w;const c=Mi(Pt({},U),{requiredNamespaces:U.requiredNamespaces});await this.client.session.set(U.topic,c),await this.setExpiry(U.topic,U.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:U.peer.metadata}),N(c)}}),!g){const{message:x}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(x)}const D=await this.sendRequest(g,"wc_sessionPropose",b),R=Xt(J.FIVE_MINUTES);return await this.setProposal(D,Pt({id:D,expiry:R},b)),{uri:u,approval:v}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:s,namespaces:a}=r,g=this.client.proposal.get(i);let{pairingTopic:u,proposer:f,requiredNamespaces:w}=g;ni(w)||(w=l0(a,"approve()"),this.client.proposal.set(i,Mi(Pt({},g),{requiredNamespaces:w})));const b=await this.client.core.crypto.generateKeyPair(),E=f.publicKey,N=await this.client.core.crypto.generateSharedKey(b,E),v={relay:{protocol:s!=null?s:"irn"},namespaces:a,requiredNamespaces:w,controller:{publicKey:b,metadata:this.client.metadata},expiry:Xt(Zr)};await this.client.core.relayer.subscribe(N);const D=await this.sendRequest(N,"wc_sessionSettle",v),{done:R,resolve:x,reject:U}=ar();this.events.once(Xe("session_approve",D),({error:d})=>{d?U(d):x(this.client.session.get(N))});const c=Mi(Pt({},v),{topic:N,acknowledged:!1,self:v.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:b});return await this.client.session.set(N,c),await this.setExpiry(N,Xt(Zr)),u&&await this.client.core.pairing.updateMetadata({topic:u,metadata:c.peer.metadata}),u&&i&&(await this.sendResult(i,u,{relay:{protocol:s!=null?s:"irn"},responderPublicKey:b}),await this.client.proposal.delete(i,ht("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:u})),{topic:N,acknowledged:R}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:s}=r,{pairingTopic:a}=this.client.proposal.get(i);a&&(await this.sendError(i,a,s),await this.client.proposal.delete(i,ht("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:s}=r,a=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:s}),{done:g,resolve:u,reject:f}=ar();return this.events.once(Xe("session_update",a),({error:w})=>{w?f(w):u()}),await this.client.session.update(i,{namespaces:s}),{acknowledged:g}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,s=await this.sendRequest(i,"wc_sessionExtend",{}),{done:a,resolve:g,reject:u}=ar();return this.events.once(Xe("session_extend",s),({error:f})=>{f?u(f):g()}),await this.setExpiry(i,Xt(Zr)),{acknowledged:a}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:s,topic:a,expiry:g}=r,u=await this.sendRequest(a,"wc_sessionRequest",{request:s,chainId:i},g),{done:f,resolve:w,reject:b}=ar(g);return this.events.once(Xe("session_request",u),({error:E,result:N})=>{E?b(E):w(N)}),await f()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:s}=r,{id:a}=s;Rt(s)?await this.sendResult(a,i,s.result):_t(s)&&await this.sendError(a,i,s.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const s=await this.sendRequest(i,"wc_sessionPing",{}),{done:a,resolve:g,reject:u}=ar();this.events.once(Xe("session_ping",s),({error:f})=>{f?u(f):g()}),await a()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:s,chainId:a}=r;await this.sendRequest(i,"wc_sessionEvent",{event:s,chainId:a})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",ht("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>g0(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,ht("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,ht("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),s?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Or.wc_sessionRequest.req.ttl,{id:s,topic:a,params:g}=r;await this.client.pendingRequest.set(s,{id:s,topic:a,params:g}),i&&this.client.core.expirer.set(s,Xt(i))},this.sendRequest=async(r,i,s,a)=>{const g=gi(i,s),u=await this.client.core.crypto.encode(r,g),f=Or[i].req;return a&&(f.ttl=a),this.client.core.history.set(r,g),this.client.core.relayer.publish(r,u,f),g.id},this.sendResult=async(r,i,s)=>{const a=_s(r,s),g=await this.client.core.crypto.encode(i,a),u=await this.client.core.history.get(i,r),f=Or[u.request.method].res;this.client.core.relayer.publish(i,g,f),await this.client.core.history.resolve(a)},this.sendError=async(r,i,s)=>{const a=pi(r,s),g=await this.client.core.crypto.encode(i,a),u=await this.client.core.history.get(i,r),f=Or[u.request.method].res;this.client.core.relayer.publish(i,g,f),await this.client.core.history.resolve(a)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(s=>{or(s.expiry)&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{or(s.expiry)&&i.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession(s)),...i.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=r=>{const{topic:i,payload:s}=r,a=s.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeRequest(i,s);case"wc_sessionSettle":return this.onSessionSettleRequest(i,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,s);case"wc_sessionExtend":return this.onSessionExtendRequest(i,s);case"wc_sessionPing":return this.onSessionPingRequest(i,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,s);case"wc_sessionRequest":return this.onSessionRequest(i,s);case"wc_sessionEvent":return this.onSessionEventRequest(i,s);default:return this.client.logger.info(`Unsupported request method ${a}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:s}=r,a=(await this.client.core.history.get(i,s.id)).request.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeResponse(i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,s);case"wc_sessionExtend":return this.onSessionExtendResponse(i,s);case"wc_sessionPing":return this.onSessionPingResponse(i,s);case"wc_sessionRequest":return this.onSessionRequestResponse(i,s);default:return this.client.logger.info(`Unsupported response method ${a}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:s,id:a}=i;try{this.isValidConnect(Pt({},i.params));const g=Xt(J.FIVE_MINUTES),u=Pt({id:a,pairingTopic:r,expiry:g},s);await this.setProposal(a,u),this.client.events.emit("session_proposal",{id:a,params:u})}catch(g){await this.sendError(a,r,g),this.client.logger.error(g)}},this.onSessionProposeResponse=async(r,i)=>{const{id:s}=i;if(Rt(i)){const{result:a}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a});const g=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const u=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:u});const f=a.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const w=await this.client.core.crypto.generateSharedKey(u,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const b=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:r})}else _t(i)&&(await this.client.proposal.delete(s,ht("USER_DISCONNECTED")),this.events.emit(Xe("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:s,params:a}=i;try{this.isValidSessionSettleRequest(a);const{relay:g,controller:u,expiry:f,namespaces:w,requiredNamespaces:b}=i.params,E={topic:r,relay:g,expiry:f,namespaces:w,acknowledged:!0,requiredNamespaces:b,controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}};await this.sendResult(i.id,r,!0),this.events.emit(Xe("session_connect"),{session:E})}catch(g){await this.sendError(s,r,g),this.client.logger.error(g)}},this.onSessionSettleResponse=async(r,i)=>{const{id:s}=i;Rt(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Xe("session_approve",s),{})):_t(i)&&(await this.client.session.delete(r,ht("USER_DISCONNECTED")),this.events.emit(Xe("session_approve",s),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:s,id:a}=i;try{this.isValidUpdate(Pt({topic:r},s)),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult(a,r,!0),this.client.events.emit("session_update",{id:a,topic:r,params:s})}catch(g){await this.sendError(a,r,g),this.client.logger.error(g)}},this.onSessionUpdateResponse=(r,i)=>{const{id:s}=i;Rt(i)?this.events.emit(Xe("session_update",s),{}):_t(i)&&this.events.emit(Xe("session_update",s),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:s}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Xt(Zr)),await this.sendResult(s,r,!0),this.client.events.emit("session_extend",{id:s,topic:r})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionExtendResponse=(r,i)=>{const{id:s}=i;Rt(i)?this.events.emit(Xe("session_extend",s),{}):_t(i)&&this.events.emit(Xe("session_extend",s),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult(s,r,!0),this.client.events.emit("session_ping",{id:s,topic:r})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionPingResponse=(r,i)=>{const{id:s}=i;setTimeout(()=>{Rt(i)?this.events.emit(Xe("session_ping",s),{}):_t(i)&&this.events.emit(Xe("session_ping",s),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),this.client.core.relayer.once(it.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(s,r,!0),this.client.events.emit("session_delete",{id:s,topic:r})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionRequest=async(r,i)=>{const{id:s,params:a}=i;try{this.isValidRequest(Pt({topic:r},a)),await this.setPendingSessionRequest({id:s,topic:r,params:a}),this.client.events.emit("session_request",{id:s,topic:r,params:a})}catch(g){await this.sendError(s,r,g),this.client.logger.error(g)}},this.onSessionRequestResponse=(r,i)=>{const{id:s}=i;Rt(i)?this.events.emit(Xe("session_request",s),{result:i.result}):_t(i)&&this.events.emit(Xe("session_request",s),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:s,params:a}=i;try{this.isValidEmit(Pt({topic:r},a)),this.client.events.emit("session_event",{id:s,topic:r,params:a})}catch(g){await this.sendError(s,r,g),this.client.logger.error(g)}},this.isValidConnect=async r=>{if(!wt(r)){const{message:u}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(u)}const{pairingTopic:i,requiredNamespaces:s,relays:a}=r;if(Ut(i)||await this.isValidPairingTopic(i),!Ut(s)&&ni(s)===0)return;const g=v0(s,"connect()");if(g)throw new Error(g.message);if(!D0(a,!0)){const{message:u}=Q("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(u)}},this.isValidApprove=async r=>{if(!wt(r))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:s,relayProtocol:a}=r;await this.isValidProposalId(i);const g=this.client.proposal.get(i),u=Qr(s,"approve()");if(u)throw new Error(u.message);const f=ho(g.requiredNamespaces,s,"update()");if(f)throw new Error(f.message);if(!nt(a,!0)){const{message:w}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(w)}},this.isValidReject=async r=>{if(!wt(r)){const{message:a}=Q("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(a)}const{id:i,reason:s}=r;if(await this.isValidProposalId(i),!O0(s)){const{message:a}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidSessionSettleRequest=r=>{if(!wt(r)){const{message:w}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(w)}const{relay:i,controller:s,namespaces:a,expiry:g}=r;if(!La(i)){const{message:w}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const u=y0(s,"onSessionSettleRequest()");if(u)throw new Error(u.message);const f=Qr(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(or(g)){const{message:w}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async r=>{if(!wt(r)){const{message:f}=Q("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:i,namespaces:s}=r;await this.isValidSessionTopic(i);const a=this.client.session.get(i),g=Qr(s,"update()");if(g)throw new Error(g.message);const u=ho(a.requiredNamespaces,s,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async r=>{if(!wt(r)){const{message:s}=Q("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!wt(r)){const{message:f}=Q("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(f)}const{topic:i,request:s,chainId:a,expiry:g}=r;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!uo(u,a)){const{message:f}=Q("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(f)}if(!x0(s)){const{message:f}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(f)}if(!N0(u,a,s.method)){const{message:f}=Q("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(f)}if(g&&!C0(g,$i)){const{message:f}=Q("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${$i.min} and ${$i.max}`);throw new Error(f)}},this.isValidRespond=async r=>{if(!wt(r)){const{message:a}=Q("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:i,response:s}=r;if(await this.isValidSessionTopic(i),!I0(s)){const{message:a}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidPing=async r=>{if(!wt(r)){const{message:s}=Q("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!wt(r)){const{message:u}=Q("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(u)}const{topic:i,event:s,chainId:a}=r;await this.isValidSessionTopic(i);const{namespaces:g}=this.client.session.get(i);if(!uo(g,a)){const{message:u}=Q("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(u)}if(!T0(s)){const{message:u}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(u)}if(!A0(g,a,s.name)){const{message:u}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(u)}},this.isValidDisconnect=async r=>{if(!wt(r)){const{message:s}=Q("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(it.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const s=await this.client.core.crypto.decode(r,i);Es(s)?(this.client.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):vs(s)&&(await this.client.core.history.resolve(s),this.onRelayEventResponse({topic:r,payload:s}))})}registerExpirerEvents(){this.client.core.expirer.on(pt.expired,async e=>{const{topic:r,id:i}=a0(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,Q("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!nt(e,!1)){const{message:r}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(or(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=Q("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!nt(e,!1)){const{message:r}=Q("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(or(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=Q("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(nt(e,!1)){const{message:r}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!S0(e)){const{message:r}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(or(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=Q("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class B0 extends mi{constructor(e,r){super(e,r,P0,Ts),this.core=e,this.logger=r}}class q0 extends mi{constructor(e,r){super(e,r,R0,Ts),this.core=e,this.logger=r}}class K0 extends mi{constructor(e,r){super(e,r,F0,Ts),this.core=e,this.logger=r}}class Ns extends Vp{constructor(e){super(e),this.protocol=$a,this.version=Ma,this.name=Li.name,this.events=new at.exports.EventEmitter,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(s){throw this.logger.error(s.message),s}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(s){throw this.logger.error(s.message),s}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(s){throw this.logger.error(s.message),s}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(s){throw this.logger.error(s.message),s}},this.update=async i=>{try{return await this.engine.update(i)}catch(s){throw this.logger.error(s.message),s}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(s){throw this.logger.error(s.message),s}},this.request=async i=>{try{return await this.engine.request(i)}catch(s){throw this.logger.error(s.message),s}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(s){throw this.logger.error(s.message),s}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(s){throw this.logger.error(s.message),s}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(s){throw this.logger.error(s.message),s}},this.find=i=>{try{return this.engine.find(i)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(e==null?void 0:e.name)||Li.name,this.metadata=(e==null?void 0:e.metadata)||o0();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Rr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Li.logger}));this.core=(e==null?void 0:e.core)||new Kp(e),this.logger=Se.generateChildLogger(r,this.name),this.session=new q0(this.core,this.logger),this.proposal=new B0(this.core,this.logger),this.pendingRequest=new K0(this.core,this.logger),this.engine=new z0(this)}static async init(e){const r=new Ns(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=Ie.getLocation=Ie.getLocationOrThrow=Ie.getNavigator=Ie.getNavigatorOrThrow=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function tr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=tr;function dr(t){const e=tr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=dr;function V0(){return dr("document")}Ie.getDocumentOrThrow=V0;function G0(){return tr("document")}Ie.getDocument=G0;function k0(){return dr("navigator")}Ie.getNavigatorOrThrow=k0;function W0(){return tr("navigator")}Ie.getNavigator=W0;function Y0(){return dr("location")}Ie.getLocationOrThrow=Y0;function J0(){return tr("location")}Ie.getLocation=J0;function X0(){return dr("crypto")}Ie.getCryptoOrThrow=X0;function Z0(){return tr("crypto")}Ie.getCrypto=Z0;function Q0(){return dr("localStorage")}Ie.getLocalStorageOrThrow=Q0;function e1(){return tr("localStorage")}Ie.getLocalStorage=e1;var As={};Object.defineProperty(As,"__esModule",{value:!0});As.getWindowMetadata=void 0;const go=Ie;function t1(){let t,e;try{t=go.getDocumentOrThrow(),e=go.getLocationOrThrow()}catch{return null}function r(){const E=t.getElementsByTagName("link"),N=[];for(let v=0;v<E.length;v++){const D=E[v],R=D.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const x=D.getAttribute("href");if(x)if(x.toLowerCase().indexOf("https:")===-1&&x.toLowerCase().indexOf("http:")===-1&&x.indexOf("//")!==0){let U=e.protocol+"//"+e.host;if(x.indexOf("/")===0)U+=x;else{const c=e.pathname.split("/");c.pop();const d=c.join("/");U+=d+"/"+x}N.push(U)}else if(x.indexOf("//")===0){const U=e.protocol+x;N.push(U)}else N.push(x)}}return N}function i(...E){const N=t.getElementsByTagName("meta");for(let v=0;v<N.length;v++){const D=N[v],R=["itemprop","property","name"].map(x=>D.getAttribute(x)).filter(x=>x?E.includes(x):!1);if(R.length&&R){const x=D.getAttribute("content");if(x)return x}}return""}function s(){let E=i("name","og:site_name","og:title","twitter:title");return E||(E=t.title),E}function a(){return i("description","og:description","twitter:description","keywords")}const g=s(),u=a(),f=e.origin,w=r();return{description:u,url:f,icons:w,name:g}}As.getWindowMetadata=t1;var r1={};(function(t){const e=is,r=ss,i=rs,s=ps,a=c=>c==null,g=Symbol("encodeFragmentIdentifier");function u(c){switch(c.arrayFormat){case"index":return d=>(h,l)=>{const y=h.length;return l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),"[",y,"]"].join("")]:[...h,[b(d,c),"[",b(y,c),"]=",b(l,c)].join("")]};case"bracket":return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),"[]"].join("")]:[...h,[b(d,c),"[]=",b(l,c)].join("")];case"colon-list-separator":return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,[b(d,c),":list="].join("")]:[...h,[b(d,c),":list=",b(l,c)].join("")];case"comma":case"separator":case"bracket-separator":{const d=c.arrayFormat==="bracket-separator"?"[]=":"=";return h=>(l,y)=>y===void 0||c.skipNull&&y===null||c.skipEmptyString&&y===""?l:(y=y===null?"":y,l.length===0?[[b(h,c),d,b(y,c)].join("")]:[[l,b(y,c)].join(c.arrayFormatSeparator)])}default:return d=>(h,l)=>l===void 0||c.skipNull&&l===null||c.skipEmptyString&&l===""?h:l===null?[...h,b(d,c)]:[...h,[b(d,c),"=",b(l,c)].join("")]}}function f(c){let d;switch(c.arrayFormat){case"index":return(h,l,y)=>{if(d=/\[(\d*)\]$/.exec(h),h=h.replace(/\[\d*\]$/,""),!d){y[h]=l;return}y[h]===void 0&&(y[h]={}),y[h][d[1]]=l};case"bracket":return(h,l,y)=>{if(d=/(\[\])$/.exec(h),h=h.replace(/\[\]$/,""),!d){y[h]=l;return}if(y[h]===void 0){y[h]=[l];return}y[h]=[].concat(y[h],l)};case"colon-list-separator":return(h,l,y)=>{if(d=/(:list)$/.exec(h),h=h.replace(/:list$/,""),!d){y[h]=l;return}if(y[h]===void 0){y[h]=[l];return}y[h]=[].concat(y[h],l)};case"comma":case"separator":return(h,l,y)=>{const n=typeof l=="string"&&l.includes(c.arrayFormatSeparator),p=typeof l=="string"&&!n&&E(l,c).includes(c.arrayFormatSeparator);l=p?E(l,c):l;const P=n||p?l.split(c.arrayFormatSeparator).map(j=>E(j,c)):l===null?l:E(l,c);y[h]=P};case"bracket-separator":return(h,l,y)=>{const n=/(\[\])$/.test(h);if(h=h.replace(/\[\]$/,""),!n){y[h]=l&&E(l,c);return}const p=l===null?[]:l.split(c.arrayFormatSeparator).map(P=>E(P,c));if(y[h]===void 0){y[h]=p;return}y[h]=[].concat(y[h],p)};default:return(h,l,y)=>{if(y[h]===void 0){y[h]=l;return}y[h]=[].concat(y[h],l)}}}function w(c){if(typeof c!="string"||c.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(c,d){return d.encode?d.strict?e(c):encodeURIComponent(c):c}function E(c,d){return d.decode?r(c):c}function N(c){return Array.isArray(c)?c.sort():typeof c=="object"?N(Object.keys(c)).sort((d,h)=>Number(d)-Number(h)).map(d=>c[d]):c}function v(c){const d=c.indexOf("#");return d!==-1&&(c=c.slice(0,d)),c}function D(c){let d="";const h=c.indexOf("#");return h!==-1&&(d=c.slice(h)),d}function R(c){c=v(c);const d=c.indexOf("?");return d===-1?"":c.slice(d+1)}function x(c,d){return d.parseNumbers&&!Number.isNaN(Number(c))&&typeof c=="string"&&c.trim()!==""?c=Number(c):d.parseBooleans&&c!==null&&(c.toLowerCase()==="true"||c.toLowerCase()==="false")&&(c=c.toLowerCase()==="true"),c}function U(c,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),w(d.arrayFormatSeparator);const h=f(d),l=Object.create(null);if(typeof c!="string"||(c=c.trim().replace(/^[?#&]/,""),!c))return l;for(const y of c.split("&")){if(y==="")continue;let[n,p]=i(d.decode?y.replace(/\+/g," "):y,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?p:E(p,d),h(E(n,d),p,l)}for(const y of Object.keys(l)){const n=l[y];if(typeof n=="object"&&n!==null)for(const p of Object.keys(n))n[p]=x(n[p],d);else l[y]=x(n,d)}return d.sort===!1?l:(d.sort===!0?Object.keys(l).sort():Object.keys(l).sort(d.sort)).reduce((y,n)=>{const p=l[n];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?y[n]=N(p):y[n]=p,y},Object.create(null))}t.extract=R,t.parse=U,t.stringify=(c,d)=>{if(!c)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),w(d.arrayFormatSeparator);const h=p=>d.skipNull&&a(c[p])||d.skipEmptyString&&c[p]==="",l=u(d),y={};for(const p of Object.keys(c))h(p)||(y[p]=c[p]);const n=Object.keys(y);return d.sort!==!1&&n.sort(d.sort),n.map(p=>{const P=c[p];return P===void 0?"":P===null?b(p,d):Array.isArray(P)?P.length===0&&d.arrayFormat==="bracket-separator"?b(p,d)+"[]":P.reduce(l(p),[]).join("&"):b(p,d)+"="+b(P,d)}).filter(p=>p.length>0).join("&")},t.parseUrl=(c,d)=>{d=Object.assign({decode:!0},d);const[h,l]=i(c,"#");return Object.assign({url:h.split("?")[0]||"",query:U(R(c),d)},d&&d.parseFragmentIdentifier&&l?{fragmentIdentifier:E(l,d)}:{})},t.stringifyUrl=(c,d)=>{d=Object.assign({encode:!0,strict:!0,[g]:!0},d);const h=v(c.url).split("?")[0]||"",l=t.extract(c.url),y=t.parse(l,{sort:!1}),n=Object.assign(y,c.query);let p=t.stringify(n,d);p&&(p=`?${p}`);let P=D(c.url);return c.fragmentIdentifier&&(P=`#${d[g]?b(c.fragmentIdentifier,d):c.fragmentIdentifier}`),`${h}${p}${P}`},t.pick=(c,d,h)=>{h=Object.assign({parseFragmentIdentifier:!0,[g]:!1},h);const{url:l,query:y,fragmentIdentifier:n}=t.parseUrl(c,h);return t.stringifyUrl({url:l,query:s(y,d),fragmentIdentifier:n},h)},t.exclude=(c,d,h)=>{const l=Array.isArray(d)?y=>!d.includes(y):(y,n)=>!d(y,n);return t.pick(c,l,h)}})(r1);const i1={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function s1(t,e){const{message:r,code:i}=i1[t];return{message:e?`${r} ${e}`:r,code:i}}function n1(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}const o1={Accept:"application/json","Content-Type":"application/json"},a1="POST",po={headers:o1,method:a1},yo=10;class wi{constructor(e){if(this.url=e,this.events=new at.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Hn(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=Cr(e),a=await(await Bs(this.url,Object.assign(Object.assign({},po),{body:i}))).json();this.onPayload({data:a})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!Hn(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const r=Cr({id:1,jsonrpc:"2.0",method:"test",params:[]});await Bs(e,Object.assign(Object.assign({},po),{body:r})),this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?ns(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),s=i.message||i.toString(),a=pi(e,s);this.events.emit("payload",a)}parseError(e,r=this.url){return ba(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>yo&&this.events.setMaxListeners(yo)}}function c1(t){var e;const r=(e=t[Object.keys(t)[0]])==null?void 0:e.chains[0];return[r.split(":")[0],r.split(":")[1]]}function zt(t,e){let r;return e.rpcMap&&(r=e.rpcMap[u1([t])]),r}function u1(t){return Number(t[0].split(":")[1])}class h1{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":{const i=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";return this.setDefaultChain(parseInt(i,16).toString()),null}case"eth_chainId":return this.getDefaultChainId()}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){if(this.chainId=parseInt(e),!this.httpProviders[e]){const i=r||zt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}requestAccounts(){return this.getAccounts()}createHttpProvider(e,r){const i=r||zt(e,this.namespace);return typeof i>"u"?void 0:new jr(new wi(i))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return parseInt(e.split(":")[1])}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}}class l1{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||zt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||zt(e,this.namespace);return typeof i>"u"?void 0:new jr(new wi(i))}}class f1{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||zt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||zt(e,this.namespace);return typeof i>"u"?void 0:new jr(new wi(i))}}class d1{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||zt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||zt(e,this.namespace);return typeof i>"u"?void 0:new jr(new wi(i))}}const mo="error",g1="wss://relay.walletconnect.com",p1="wc",y1="universal_provider",bo=`${p1}@${2}:${y1}:`;var m1=Object.defineProperty,b1=Object.defineProperties,w1=Object.getOwnPropertyDescriptors,wo=Object.getOwnPropertySymbols,_1=Object.prototype.hasOwnProperty,E1=Object.prototype.propertyIsEnumerable,_o=(t,e,r)=>e in t?m1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Eo=(t,e)=>{for(var r in e||(e={}))_1.call(e,r)&&_o(t,r,e[r]);if(wo)for(var r of wo(e))E1.call(e,r)&&_o(t,r,e[r]);return t},v1=(t,e)=>b1(t,w1(e));class Cs{constructor(e){this.events=new at.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Rr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||mo}))}static async init(e){const r=new Cs(e);return await r.initialize(),r}async request(e,r){const[i,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Eo({},e),chainId:`${i}:${s}`,topic:this.session.topic})}sendAsync(e,r,i){this.request(e,i).then(s=>r(null,s)).catch(s=>r(s,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:s1("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");const{namespaces:r}=e;return this.setNamespaces(r),this.createProviders(),await this.cleanupPendingPairings(),e.skipPairing===!0?void 0:await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces});return r&&(this.uri=r,this.events.emit("display_uri",r)),this.session=await i(),this.onSessionUpdate(),this.onConnect(),this.session}setDefaultChain(e,r){try{const[i,s]=this.validateChain(e);this.getProvider(i).setDefaultChain(s,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(n1(r)){for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${bo}/namespaces`)||{},this.namespaces&&this.createProviders(),this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.onSessionUpdate()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Ns.init({logger:this.providerOpts.logger||mo,relayUrl:this.providerOpts.relayUrl||g1,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{switch(e){case"eip155":this.rpcProviders[e]=new h1({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"solana":this.rpcProviders[e]=new l1({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"cosmos":this.rpcProviders[e]=new f1({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new d1({client:this.client,namespace:this.namespaces[e],events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:i}=r;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(i.data,r.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:s}=r,a=(i=this.client)==null?void 0:i.session.get(e);this.session=v1(Eo({},a),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${bo}/namespaces`,e),this.namespaces=e}validateChain(e){const[r,i]=(e==null?void 0:e.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);return!r||!i?c1(this.namespaces):[r,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r){const[i,s]=this.validateChain(r);this.getProvider(i).setDefaultChain(s),this.events.emit("chainChanged",e)}onConnect(){this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.rpcProviders={},await this.cleanupPendingPairings({deletePairings:!0})}}const I1=Cs;export{I1 as UniversalProvider,Cs as default};
